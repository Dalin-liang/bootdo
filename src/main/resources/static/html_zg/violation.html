<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<!-- 设置360浏览器渲染模式,webkit 为极速内核，ie-comp 为 IE 兼容内核，ie-stand 为 IE 标准内核。 -->
	<meta name="renderer" content="webkit">
	<meta name="google" value="notranslate">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<title>正果两违监测</title>
	<link rel="stylesheet" href="plugin/bootstrap4/bootstrap.css" />
	<link rel="stylesheet" href="plugin/font/font-awesome@4.7.0/css/font-awesome.min.css" />
	<link rel="stylesheet" href="css/iconfont.css" />
	<link rel="stylesheet" href="css/common.css" />
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/table.css" />
	<script type="text/javascript" src="plugin/jquery-1.11.3/jquery.min.js"></script>
	<script type="text/javascript" src="plugin/echarts.js"></script>
	<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=f298e5e7038506323629972a84492e89"></script>
	<script type="text/javascript" src="plugin/mapPlugin.js"></script>
    <style>
        .content-left .item{
            margin-bottom: 20px!important;
        }
		.content-b{
			background-color:rgba(0, 41, 133, 0.4)!important;
		}
		#map-cont{
			height: 100%;
		}
		.amap-info-close{
			font-size: 18px;
			top:10px;
		}
		.amap-info-content table th{
			text-align: center;
			font-weight: 500;
		}
		.amap-info-content table tr{
			height: 40px;
		}
		.amap-info-content table td{
			line-height: 40px ;
		}
		.amap-info-content table .warn{
			background-color: red;
		}
		#planList{
			position: relative;
		}
		.pop_box{
			width: 400px;
			padding:5px 10px;
		}
		.pop_tl{
			line-height: 35px;
			background: #1d90c5;
			padding: 0 10px;
		}

		.pop_box table{
			width: 100%;
		}
		.pop_box table tbody tr td{
			vertical-align: top;
		}
		.amap-info-content{
			border: #03A9F4 thin solid;
			background: rgba(37,88,139,0.8);
			padding: 0;
			font-size: 14px;
			line-height: 24px;
		}
		.bottom-center .amap-info-sharp{
			border-top-color: #03A9F4;
		}
		.amap-info-content table.table-bordered tr{
			height: auto!important;
		}
		.content{
			top:80px;
			bottom: 0;
		}
		#map-cont{
			width: calc(100% - 920px);
			height: calc(100% - 80px);
			left: 460px;
			top: 80px;
		}
    </style>
</head>
<body style="background-color: rgb(0,13,55);">
    <!--<div class="map">
		<div class="example-map" style="background-image: url(images/map.png)"></div>
    </div>-->

    <div class="toggle_nav" style="top: 110px;width: 688px;margin: 0 auto;">
			<div class="toggle_nav_btn">
				<span class="fa fa-angle-double-down fa-angle-double-up"></span>
			</div>
			<div class="toggle_nav_con">
				<a class="" href="party.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/15.png"/>
						</div>
						<p>智慧党建</p>
					</div>
				</a>
				<a class="" href="administration.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/14.png"/>
						</div>
						<p>政务分析</p>
					</div>
				</a>
				<a class="" href="population.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/10.png"/>
						</div>
						<p>人口分析</p>
					</div>
				</a>
				<a class="" href="legalAnalysis.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/05.png"/>
						</div>
						<p>法人分析</p>
					</div>
				</a>
				<a class="" href="travel.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/09.png"/>
						</div>
						<p>旅游分析</p>
					</div>
				</a>
				<a class="" href="poverty.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/04.png"/>
						</div>
						<p>党内帮扶</p>
					</div>
				</a>
				<a class="" href="traffic.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/13.png"/>
						</div>
						<p>正果交通</p>
					</div>
				</a>
				<a class="" href="fireFighting.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/12.png"/>
						</div>
						<p>消防安全</p>
					</div>
				</a>
				<a class="" href="specialPop.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/11.png"/>
						</div>
						<p>特殊人群</p>
					</div>
				</a>
				<a class="" href="urbanecology.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/03.png"/>
						</div>
						<p>城市生态</p>
					</div>
				</a>
				<a class="" href="security.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
							<img src="img/17.png"/>
						</div>
						<p>综治形势</p>
					</div>
				</a>
				<a class="" href="violation.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
							<img src="img/08.png"/>
						</div>
						<p>两违监测</p>
					</div>
				</a>
				<a class="" href="safety.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
							<img src="img/01.png"/>
						</div>
						<p>安全生产</p>
					</div>
				</a>
				<a class="" href="dangerous.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/16.png"/>
						</div>
						<p>重点隐患</p>
					</div>
				</a>
				<a class="" href="industry.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/02.png"/>
						</div>
						<p>产业分析</p>
					</div>
				</a>
				<a class="" href="industrialAnalysis.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/06.png"/>
						</div>
						<p>工业增加值</p>
					</div>
				</a>
				<a class="" href="development.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/07.png"/>
						</div>
						<p>经济发展</p>
					</div>
				</a>
				<a class="" href="http://113.108.176.67:9094/login">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/02.png"/>
						</div>
						<p>后台管理</p>
					</div>
				</a>
				<a class="" href="index.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/18.png"/>
						</div>
						<p>城市运行特征</p>
					</div>
				</a>
				<a class="" href="http://172.27.162.37:8011/zgrms/Pages/main/mainPage.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/19.png"/>
						</div>
						<p>三防监测分析</p>
					</div>
				</a>
				<a class="" href="good_poverty.html">
					<div class="inblock toggle_nav_li">
						<div class="img">
						<img src="img/20.png"/>
						</div>
						<p>优秀扶贫项目</p>
					</div>
				</a>
			</div>
		</div>
	<div id="map-cont"></div>
	<div class="header flex flex-m">
		<div class="title PangMen">正果两违监测</div>
	</div>

    <div class="content content-left flex flex-v" style="width: 450px;color: #0CFFFD;text-align: center">
        <div class="item">
			<div class="hd"><span>违章建筑情况</span></div>
                <div class="flex-1 content-left" style="width: 48%;display: inline-block;text-align: center;margin-bottom: 10px;">
					<span>查处违法违章建筑数：</span><div class="math Digital rfc-info shadow di">300起</div>
				</div>
                <div class="bd flex flex-m" style="height:250px;width: 100%;color:white;" id="chart1">

                </div>
        </div>
        <div class="item">
            <div class="flex-1 content-left" style="width: 48%;display: inline-block;text-align: center;margin-bottom: 10px;">
                <span>处理违法违章建筑数：</span><div class="math Digital rfc-info shadow di">280起</div>
            </div>
            <div class="bd flex flex-m" style="height:250px;width: 100%;color:white;" id="chart2">

            </div>
        </div>
        <div class="item">
            <div class="hd"><span>年度查处违章建筑情况</span></div>
            <div class="bd flex flex-m" style="height:250px;width: 100%;color:white;" id="chart3">

            </div>
        </div>
    </div>
    <div class="content content-right flex flex-v" style="width: 450px;">
         <div class="item">
            <div class="hd"><span>两违执法情况</span></div>
            <div class="bd flex flex-m" style="height:420px;width: 100%;color:white;" id="chart4">

            </div>
        </div>
        <div class="item">
            <div class="hd"><span>整改违章建筑情况</span></div>
            <div class="bd flex flex-m" style="height:420px;width: 100%;color:white;" id="chart5">

            </div>
        </div>
    </div>
</body>
<script>
	var mapComp;
	var map;
	mapComp = new MapComp();
    mapComp.init();
    var dom = document.getElementById("chart1");
    var myChart = echarts.init(dom);
    option = null;
    option = {
	    tooltip : {
	        formatter: "{a} <br/>{b} : {c}%"
	    },
        grid:{
	        y:0,
            y2:0
        },
	    series: [
	        {
	            radius:'100%',
	            name: '违法违章建筑',
	            type: 'gauge',
                title:{
	                textStyle:{
	                    color:'white'
                    }
                },
	            detail: {formatter:'{value}%'},
	            data: [{value: 98, name: '查处率'}]
	        }
	    ]
	};
    if (option && typeof option === "object") {
        myChart.setOption(option, true);
    }
    var dom1 = document.getElementById("chart2");
    var myChart1 = echarts.init(dom1);
    option1 = null;
    option1 = {
	    tooltip : {
	        formatter: "{a} <br/>{b} : {c}%"
	    },
        grid:{
	      bottom:1,
            top:1
        },
	    series: [
	        {
                radius:'100%',
                name: '违法违章建筑',
                type: 'gauge',
                title:{
	                textStyle:{
	                    color:'white'
                    }
                },
                detail: {formatter:'{value}%'},
	            data: [{value: 90, name: '处理率'}]
	        }
	    ]
	};
if (option1 && typeof option1 === "object") {
    myChart1.setOption(option1, true);
}

var dom2 = document.getElementById("chart3");
    var myChart2 = echarts.init(dom2);
    option2 = null;
    option2 = {
	    tooltip: {
	        trigger: 'axis',
	        axisPointer: {
	            type: 'cross',
	            crossStyle: {
	                color: 'white'
	            }
	        }
	    },
	    legend: {
	        data:['查处违法违章建筑'],
            textStyle:{
	            color:'white'
			}
	    },
	    xAxis: [
	        {
	            type: 'category',
	            data: ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'],
                axisLabel: {
            	    color: 'white'
        	    }
	        }

	    ],
	    yAxis: [
	        {
	            name:'数量(起)',
	            type: 'value',
                axisLabel: {
            	    color: 'white'
        	    },
			    nameTextStyle:{
             	    color:'white'
			    }
	        }
	    ],
	    series: [
	        {
	            name:'查处违法违章建筑',
	            type:'line',

	            smooth: true,
	            data:[20, 22, 33, 35, 43, 29, 20, 23, 23, 16, 12, 6]
	        }
	    ]
	};



if (option2 && typeof option2 === "object") {
    myChart2.setOption(option2, true);
}

var dom3 = document.getElementById("chart4");
var myChart3 = echarts.init(dom3);
option3 = null;
option3 = {
    tooltip: {
        trigger: 'axis',
        axisPointer: {
            type: 'cross',
            crossStyle: {
                color: 'white'
            }
        }
    },
    legend: {
        data:['查扣物资','罚款数','黑名单车辆','执法人员数'],
        textStyle:{
            color:'white'
        }
    },
    xAxis: [
        {
            type: 'category',
            data: ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'],
            axisPointer: {
                type: 'shadow'
            },
            axisLabel: {
            	    color: 'white'
            }
        }
    ],
    yAxis: [
        {
            type: 'value',
            name: '数量',
            min: 0,
            max: 250,
            interval: 50,
            axisLabel: {
                formatter: '{value} 个',
                color: 'white'
            },
            nameTextStyle:{
                color:'white'
            }
        },{
            type: 'value',
            name: '金额',
            min: 0,
            max: 200,
            interval: 100,
            axisLabel: {
                formatter: '{value} 万',
                color: 'white'
            },
            nameTextStyle:{
                color:'white'
            }
        }
    ],
    series: [
        {
            name:'查扣物资',
            type:'bar',
            data:[115, 135, 172, 152, 158, 193, 112, 135, 142, 136, 144, 132]
        },
        {
            name:'罚款数',
            type:'bar',
            data:[12.6, 25.9, 29.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3]
        },
        {
            name:'黑名单车辆',
            type:'bar',
            data:[112, 135, 142, 136, 144, 132, 135, 172, 152, 158, 193,115]
        },
        {
            name:'执法人员数',
            type:'bar',
            data:[12, 15, 12, 16, 14, 12, 15, 12, 12, 18, 13,15]
        }
    ]
};

if (option3 && typeof option3 === "object") {
    myChart3.setOption(option3, true);
}

var dom4 = document.getElementById("chart5");
var myChart4 = echarts.init(dom4);
option4 = null;
option4 = {
	    tooltip : {
	        trigger: 'axis',
	        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
	            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
	        },
            crossStyle: {
                color: 'white'
            }
	    },
	    legend: {
	        data:['拆除面积','控停面积','总  面  积'],
            textStyle:{
                color:'white'
            }
	    },
	    grid: {
	        /*left: '3%',
	        right: '4%',
	        bottom: '3%',*/
	        containLabel: true
	    },
	    xAxis : [
	        {
	            type : 'category',
	            data : ['2013年','2014年','2015年','2016年','2017年','2018年','2019年'],
                axisLabel: {
            	    color: 'white'
                }
	        }
	    ],
	    yAxis : [
	        {
	        	name:'面积（平方米）',
	            type : 'value',
                axisLabel: {
                    color: 'white'
                },
                nameTextStyle:{
                    color:'white'
                }
	        }
	    ],
	    series : [
	        {
	            name:'拆除面积',
	            type:'bar',
	            data:[320, 332, 301, 334, 390, 330, 320]
	        },
	        {
	            name:'控停面积',
	            type:'bar',
	            data:[120, 132, 101, 134, 90, 230, 210]
	        },
	        {
	            name:'总  面  积',
	            type:'bar',
	            data:[440, 464, 402, 468, 480, 560, 530]

	        }
	    ]
	};



if (option4 && typeof option4 === "object") {
    myChart4.setOption(option4, true);
}

function MapComp(){
		var domId="map-cont";
		var _center = [113.892436,23.416955];
		var _map;
		var _def_zoom=12;
		var _curr_zoom = _def_zoom;
		var _max_zoom=20;
		var _min_zoom=8;
		this.init = function(){
			_map = new AMap.Map(domId, {
				/*mapStyle: "amap://styles/dark"	,*/
				zoom:_curr_zoom,//级别
				center: _center,//中心点坐标
				expandZoomRange:true,
				zooms:[_min_zoom,_max_zoom],
				layers:[
					new AMap.TileLayer.Satellite(),
					new AMap.TileLayer.RoadNet()
				]
			});
			map=_map;
		};
	}
	$.ajax({
        url: '/api/car/serviceMonitor/getByName',
        dataType: 'json',
        type: 'post',
        success: function (data) {
            for(var i in data) {
                if (data[i].lng) {
                    var lonlat = GPS.WGStoGCJ(data[i].lat, data[i].lng);
                    var marker = new AMap.Marker({
                        position: new AMap.LngLat(lonlat.lon, lonlat.lat),
                        offset: new AMap.Pixel(-10, -10),
                        icon: 'img/mapIcon/7_01.png',
                        data: data[i]
                    })
                    marker.on('click', showIData);
                    map.add(marker);
                }
            }
        }
    })

	function showIData(e){
		var id=e.target.get("data").id;
		 $.ajax({
			 url: '/api/car/serviceMonitor/getDeviceDataById',
			 dataType: 'json',
			 type: 'post',
			 data: {
				 id: id
			 },
			 success:function(data){
				 var deviceInfo=data.deviceInfo.id;
				 var status=data.deviceInfo.status=="1"?"正常":'异常';
				 var po=(data.deviceInfo.lng?data.deviceInfo.lng:'')+","+(data.deviceInfo.lat?data.deviceInfo.lat:'');
				var lnglat=[e.lnglat.lng,e.lnglat.lat]
				var content=[
					"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>两违监测:</div>",
					"<div style='color:white;padding-left: 10px;' class='pop_box'>设备信息："+(deviceInfo?deviceInfo:'')+"</div>",
					"<div style='color:white;padding-left: 10px;'>经纬度："+po+"</div>",
					"<hr/><div style='color:white;padding-left: 10px;'>状态："+(status?status:'')+"</div>",
					"<div style='color:white;padding-left: 10px;'>更新时间："+(data.deviceInfo.dataupdatetime?data.deviceInfo.dataupdatetime:'')+"</div>",
					"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
				]
				console.log(content.join("<br>"));
				var infoWindow = new AMap.InfoWindow({
					content: content.join("<br>")
				});

				// 打开信息窗体
				infoWindow.open(map,lnglat);
			 }
		 })
	}

$(document).ready(function(){
			$(".toggle_nav_btn").click(function(){
				$(".toggle_nav_btn").find(".fa").toggleClass("fa-angle-double-down")
				$(".toggle_nav_con").slideToggle()
			})
		})
</script>
</html>