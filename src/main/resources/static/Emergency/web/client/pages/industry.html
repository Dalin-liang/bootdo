<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<!-- 设置360浏览器渲染模式,webkit 为极速内核，ie-comp 为 IE 兼容内核，ie-stand 为 IE 标准内核。 -->
		<meta name="renderer" content="webkit">
		<meta name="google" value="notranslate">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<title>正果应急指挥调度平台</title>

		<link rel="stylesheet" href="../layui/css/layui.css" />
		<link rel="stylesheet" href="../js/layer_v3.1.1/mobile/need/layer.css" media="all">
		<link rel="stylesheet" href="../css/bootstrap.min.css" />
		<link rel="stylesheet" href="../sweetalert/sweetalert.css">
		<link rel="stylesheet" href="../css/bace.css" />
		<link rel="stylesheet" href="../css/style.css" />
		<link rel="stylesheet" type="text/css" href="../css/fonts/font-awesome.min.css"/>
		
		<script type="text/javascript" src="../js/jquery-1.11.3/jquery.min.js" ></script>
		<script type="text/javascript" src="../js/jquery.marquee.js" ></script>
		<script type="text/javascript" src="../js/bootstrap.min.js" ></script>


		<script type="text/javascript" src="../js/page/common.js" ></script>
		<script type="text/javascript" src="../js/page/industry.js" ></script>
		<script type="text/javascript" src="../layui/layui.all.js" ></script>
		<script type="text/javascript" src="../sweetalert/sweetalert.min.js"></script>
		 <!--高德-->
		<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=f298e5e7038506323629972a84492e89"></script>
		<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=f298e5e7038506323629972a84492e89&plugin=AMap.Driving"></script>
		<!--web socket-->
		<script type="text/javascript" src="../js/ws/sockjs.min.js"></script>
		<script type="text/javascript" src="../js/ws/stomp.min.js"></script>
	</head>
	<body>
		<div class="header">
			<div class="time text-center inblock styletime">
				<p class="font30" id="time">16：30</p>
				<p id="week">星期三 2019/05/14</p>
			</div>
			<div class="weath inblock">
				<div class="inblock">
					<span class="icon">
						<img src="../img/2_10.png" width="32" height="32"/>
					</span>
					<span id="weather">多云 27°C</span>
				</div>
				<!--<div class="inblock">
					<span class="icon">
						<img src="../img/2_12.png"/>
					</span>
					蓝色暴雨预警
				</div>-->
			</div>
			<div class="title">
				正果应急指挥调度平台
			</div>
			<div class="user inblock pull-right">
				<a id="admin">
					<div class="inblock">
						<span class="icon">
							<img src="../img/2_03.png"/>
						</span>
						综合态势
					</div>					
				</a> 
				<a id="setting">
					<div class="inblock">
						<span class="icon"><img src="../img/2_05.png"/></span>
						设&ensp;置
					</div>					
				</a>
				<a id="logout">
					<div class="inblock">
						<span class="icon"><img src="../img/2_07.png"/></span>
						退&ensp;出
					</div>					
				</a>
			</div>
		</div>
		<div class="cont relative" >
			<div class="left-show" style="position: absolute;left:10px;top:10px;z-index: 90"><button class="ind_btn left-btn"><span class="fa fa-angle-right font16"></span>事件列表</button></div>
			<div class="inblock pad10 leftP" style="width: 340px;position: relative;z-index: 100;">
				<div class="comborder5" style="height: 500px;">
					<div class="border chart_warn">
						<div class="title">
							<span class="font16"><i class="fa fa-arrow-circle-o-left tab-hide"></i> </span>事件列表
							<a class="font16 pull-right" id="unevenbtn">
								<i class="fa fa-list"></i>
							</a>
						</div>
						<div class="srcollcom" style="height: 418px;">
							<div class="pad10" id="planList">
							</div>
						</div>
						<div class="warn_b font12">
							<b class="colornum">3</b> 条处理中
							<a class="font16 pull-right addEvent"><i class="fa fa-plus-circle"></i></a>
						</div>
					</div>
				</div>
				<div class="comborder5 mt10" style="height: 450px;">
					<div class="border chart_warn">
						<div class="title">
							事件动态
							<button class="btn btn-primary btn-xs pull-right" id="addtask" >指令下达</button>
						</div>
						<ul id="myTab1" class="nav table_nav">
						    <li class="active">
						        <a href="#LogList" data-toggle="tab">
						           	事件信息
						        </a>
						    </li>
						    <li class="">
						        <a href="#taskTab" data-toggle="tab">
						           	预案任务
						        </a>
						    </li>
							<li class="">
						        <a href="#taskTab1" data-toggle="tab">
						           	新增任务
						        </a>
						    </li>
						</ul>
						<div class="tab-content" style="height: 360px;">
							<div class="tab-pane fade in active pad10" id="LogList" style="height: 360px;overflow-y: auto;">

							</div>
							<div class="tab-pane fade" id="taskTab" style="height: 360px;">
								<div class="pad10" id="list" style="height: 320px;overflow-y: auto;">

								</div>
								<div class="warn_b unevent_b" style="position: absolute;bottom: 0;width: 100%;">
									<div class="clearfix"></div>
									<!--<button class="btn btn-success btn-xs" id="edittask">修改</button>
									<button class="btn btn-default btn-xs" id="deletetask">删除</button>-->
									<button class="btn btn-warning btn-xs pull-right" id="feedback1">反馈</button>
								</div>
							</div>
							<div class="tab-pane fade" id="taskTab1" style="height: 360px;">
								<div class="pad10" id="list1" style="height: 320px;overflow-y: auto;">

								</div>
								<div class="warn_b unevent_b" style="position: absolute;bottom: 0;width: 100%;">
									<div class="clearfix"></div>
									<!--<button class="btn btn-success btn-xs" id="edittask">修改</button>
									<button class="btn btn-default btn-xs" id="deletetask">删除</button>-->
									<button class="btn btn-warning btn-xs pull-right" id="feedback2">反馈</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="inblock pad10 pull-right" id="rightPanel" style="width: 380px;position: relative;z-index: 100;display: none;">
				<div class="comborder5" style="height: 500px;">
					<div class="border chart_warn">
						<div class="title">
							当前事件
						</div>
						<ul id="myTab3" class="nav table_nav">
						    <li class="active">
						        <a href="#tab3" data-toggle="tab">
						           	事件详情
						        </a>
						    </li>
						    <li class="">
						        <a href="#tab4" data-toggle="tab">
						           	天气情况
						        </a>
						    </li>
						</ul>
						<div class="tab-content  pad10">
							<div class="tab-pane fade in active" id="tab3">
								<div class="" style="">
									<div style="height: 360px;overflow-y: auto;">
										<table class="table noborder" id="d2t">

										</table>
									</div>
									<div class="text-center mt10 mb10" style="bottom: 0;position: absolute;width: calc(100% - 20px)">
										<button class="btn btn-success" id="relocate">二次定位</button>
										<button class="btn btn-warning" id="feedback">反馈</button>
									</div>
								</div>
							</div>
							<div class="tab-pane fade" id="tab4">
								<div class="" style="">
									<div style="height: 360px;overflow-y: auto;">
										<table class="table noborder" id="weatherlist" style="text-align: center">

										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="comborder5 mt10" style="height: 450px;">
					<div class="border chart_warn">
						<div class="title">
							周边资源
						</div>
						<ul id="myTab" class="nav table_nav">
						    <li class="">
						        <a href="#tab1" data-toggle="tab">
						           	周边信息
						        </a>
						    </li>
						    <li class="active">
						        <a href="#tab2" data-toggle="tab">
						           	可调资源
						        </a>
						    </li>
						</ul>
						<div class="tab-content  pad10">
						    <div class="tab-pane fade wain_chart" id="tab1">
						    	<div class="col-xs-3">
						    		关注人群
						    	</div>
						    	<div class="col-xs-9">
							    	<table id="crowdTable" class="table tab_table text-center">

							    	</table>
						    	</div>
						    	<div class="col-xs-3">
						    		关注建筑
						    	</div>
						    	<div class="col-xs-9">
							    	<table id="buildingTable" class="table tab_table text-center">

							    	</table>
						    	</div>
						    	<div class="col-xs-3">
						    		参考案例
						    	</div>
						    	<div class="col-xs-9">
							    	<table class="table tab_table text-center" id="caseTable">

							    	</table>
						    	</div>
						    </div>
						    <div class="tab-pane fade  in active" id="tab2">
						       <table class="table table-bordered text-center">
						    		<tr>
						    			<td>
						    				选择
						    			</td>
						    			<td>
						    				类型
						    			</td>
						    			<td>
						    				数量
						    			</td>
						    			<td>
						    				操作
						    			</td>
						    		</tr>
						    		<tr>
						    			<td>
						    				<a class="font16 check_list pad5">
						    					<i class="fa fa-check-square-o"></i>
						    				</a>
						    			</td>
						    			<td>
						    				应急队伍
						    			</td>
						    			<td>
						    				3个
						    			</td>
						    			<td class="font16 text-center">
						    				<a class="pad5 colorgreen sms">
						    					<i class="fa fa-envelope-o"></i>
						    				</a>
						    			</td>
						    		</tr>
						    		<tr>
						    			<td>

						    			</td>
						    			<td>
						    				专家
						    			</td>
						    			<td id="showExp">
						    				3个
						    			</td>
						    			<td class="font16 text-center">
						    				<a class="pad5 colorgreen sms">
						    					<i class="fa fa-envelope-o"></i>
						    				</a>
						    			</td>
						    		</tr>
						    		<tr>
						    			<td>

						    			</td>
						    			<td>
						    				值守人员
						    			</td>
						    			<td>
						    				3个
						    			</td>
						    			<td class="font16 text-center">
						    				<a class="pad5 colorgreen sms">
						    					<i class="fa fa-envelope-o"></i>
						    				</a>
						    			</td>
						    		</tr>
						    		<tr>
						    			<td>
						    				<a class="font16 check_list pad5">
						    					<i class="fa fa-check-square-o"></i>
						    				</a>
						    			</td>
						    			<td>
						    				监控视频
						    			</td>
						    			<td>
						    				3个
						    			</td>
						    			<td class="font16 text-center">
											<a class="pad5 colorgreen play">
						    					<i class="fa fa-play"></i>
						    				</a>
						    			</td>
						    		</tr>
						    		<tr>
						    			<td>
						    				<a class="font16 check_list pad5">
						    					<i class="fa fa-check-square-o"></i>
						    				</a>
						    			</td>
						    			<td>
						    				应急装备
						    			</td>
						    			<td>
						    				3个
						    			</td>
						    			<td class="font16 text-center">
						    				<a class="pad5 colorgreen sms">
						    					<i class="fa fa-envelope-o"></i>
						    				</a>

						    			</td>
						    		</tr>
						    	</table>
						    </div>
						</div>
					</div>
				</div>
			</div>
			<div id="map-cont"  class="ind_map" style="z-index: 0;">
			</div>
			<div class="">
				<!--地图放大缩小-->
				<div class="zoom ind_btn font24">
					<span id="btn_map_back_center" class="zoom1 inblock"></span>
					<span id="btn_map_zoom_out" class="zoom2">-</span>
					<span id="btn_map_zoom_in" class="zoom3">+</span>
				</div>
				
				<!--右侧导航-->
				<div class="ind_nav" style="top:70px;">

					<div style="width: 72px;height: 72px;"></div>
					<a>
						<div class="ind_nav_li ind_nav_st">
							<i class="fa fa-bars fa-3x mapMenu" style="color:rgb(143,179,214)"></i>

							<div class="ind_nav_sec" style="top:-85px;right: 85px;width: 160px;z-index:9;">
								<div style="float: left;width:70px;">
									<a>
										<div class="ind_nav_li ind_nav_st" id="camera" title="摄像头">
											<img src="../img/7_03.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="team" title="应急队伍">
											<i class="fa fa-users"></i>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="watchman_btn" title="值守人员">
											<i class="fa fa-user"></i>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="specialist_btn" title="专家">
											<i class="fa fa-user-secret"></i>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="vehicles" title="应急车辆">
											<img src="../img/7_08.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="supplies" title="应急物资">
											<img src="../img/7_10.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="equipment" title="应急装备">
											<img src="../img/7_12.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="emphasis" title="保护对象">
											<img src="../img/7_14.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="hydrant" title="消防栓">
											<img src="../img/7_28.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="hut" title="健康小屋">
											<img src="../img/7_23.png"/>
										</div>
									</a>
								</div>
								<div style="width: 70px;float: right;">
									<a>
										<div class="ind_nav_li" id="sGroup" title="特殊人群">
											<img src="../img/7_29.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="light" title="智慧路灯">
											<img src="../img/7_25.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="wstation" title="水质监测">
											<img src="../img/7_26.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="rstation" title="水雨情">
											<img src="../img/7_27.png"/>
										</div>
									</a>
									<a>	
										<div class="ind_nav_li" id="astation" title="AQI">
											<img src="../img/7_20.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="behavior" title="行为识别">
											<img src="../img/7_30.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="illegal" title="两违监测">
											<img src="../img/7_21.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="passenger" title="客流量">
											<img src="../img/7_24.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" id="face" title="人脸识别">
											<img src="../img/7_22.png"/>
										</div>
									</a>
									<a>
										<div class="ind_nav_li" title="综合查询" id="mapSearch">
											<i class="fa fa-search"></i>
										</div>
									</a>
								</div>

								<!--<form class="layui-form" action="">
									<div class="layui-input-block" style="margin-left: 0!important;">
									  <input type="checkbox" name="map[camera]" lay-filter="camera" title="摄像头">
									  <input type="checkbox" name="map[team]" lay-filter="team" title="应急队伍">
									  <input type="checkbox" name="map[watchman]" lay-filter="watchman" title="值守人员">
									  <input type="checkbox" name="map[expert]" lay-filter="expert" title="专家">
									  <input type="checkbox" name="map[goods]" lay-filter="goods" title="应急物资">
									  <input type="checkbox" name="map[equipment]" lay-filter="equipment" title="应急装备">
									  <input type="checkbox" name="map[emphasis]" lay-filter="emphasis" title="保护对象">
									</div>
								</form>-->
							</div>
						</div>
					</a>
					<!--<a>
						<div class="ind_nav_li ind_nav_st">
							<img src="../img/7_14.png"/>
							<div class="ind_nav_sec" style="top: -100%;">
								<a>
									<div class="ind_nav_li">
										<i class="fa fa-graduation-cap"></i>
									</div>
								</a>
							 	<a>
									<div class="ind_nav_li" style="font-size: 34px;padding-top: 5px;">
										<i class="fa fa-hospital-o"></i>
									</div>
								</a>
								<a>
									<div class="ind_nav_li">
										<i class="fa fa-plus-square"></i>
									</div>
								</a>
							</div>
						</div>						
					</a>-->
				</div>
				
				<!--报警弹出框-->
				<div class="tab-content " id="operat_dia" style="position: absolute; right: 400px;bottom: 180px;display: none;z-index:10;">
					
					<!--预案列表-->
				    <div class="tab-pane fade comborder5 in active" id="tab_case" style="width: 580px;">
						<div class="tl comtl">
							报警号：<span id="caseid">2019060600001001</span>
							<span class="close">x</span>
						</div>
						<div class="pad20 ind_cont font12 clearfix droptype">
							<div class="col-xs-5 ">
								<div class="clearfix">
									<div class="col-xs-4 pad5 text-right">
										事故类型 :
									</div>
									<div class="col-xs-8 pad0">
										<!--<input class="form-control" id="event_type" />-->
										<div class="dropdown com_dropdown casetype" id="event_type">
										    <button type="button" class="btn btn-block line-clamp"  data-toggle="dropdown">
										    	<span class="txt">请选择事故类型</span>
										        <span class="caret"></span>
										    </button>
										    <ul class="srcollcom dropdown-menu btn-block" role="menu"  style="max-height: 220px;">
										       
										    </ul>
										</div>
									</div>
								</div>
								<div class="mt10">
									<div class="col-xs-4 pad5 text-right">
										预警级别 :
									</div>
									<div class="col-xs-8 pad0">
										<!--<input class="form-control" id="warn_type" />-->
										<div class="dropdown com_dropdown caselevel" id="warn_level">
										    <button type="button" class="btn btn-block line-clamp"  data-toggle="dropdown">
										    	<span class="txt">请选择预警级别</span>
										        <span class="caret"></span>
										    </button>
										    <ul class="srcollcom dropdown-menu btn-block" role="menu"  style="max-height: 220px;">
										       
										    </ul>
										</div>
									</div>
								</div>							
							</div>
							<div class="col-xs-6" style="width: 45%;">
								<div class="clearfix">
									<div class="col-xs-4 pad5 text-right">
										预警类别 :
									</div>
									<div class="col-xs-8 pad0">
										<!--<input class="form-control" id="warn_level" />-->
										<div class="dropdown com_dropdown casewarn" id="warn_type">
										    <button type="button" class="btn btn-block line-clamp"  data-toggle="dropdown">
										    	<span class="txt">请选择预警类别</span>
										        <span class="caret"></span>
										    </button>
										    <ul class="srcollcom dropdown-menu btn-block" role="menu"  style="max-height: 220px;">
										        
										    </ul>
										</div>
									</div>								
								</div>	
								<!--<div class="mt10">
									<div class="col-xs-4 pad5 text-right">
										关键字 :
									</div>
									<div class="col-xs-8 pad0">
										<input class="form-control" type="" name="" id="" value="" />
									</div>								
								</div>				-->
							</div>
							<div class="col-xs-1" style="width: 13%;">
								<button class="btn btn-warning btn-xs btn_ind" onclick="queryPlan()">查 询</button>
							</div>
							<div class="clearfix"></div>
							<div class="" id="tabinfo">
								<div class="col-xs-5 mt10" style="height: 400px;">
									<p style="height: 30px;line-height: 30px;">推荐预案：</p>
									<div class="case_control pad10 srcollcom" id="case_list">
										<!--<p class="colorblue">测试测试</p>
										<p>测试测试</p>
										<p>测试测试</p>
										<p>测试测试</p>-->
									</div>
								</div>
								<div class="col-xs-7" style="height: 400px;">
									<div class="pad10" style="height: 100%;overflow-y: auto;">
										<table class="table noborder" style="background-color: #093661;">

										</table>
									</div>
									<!--<div class="mt10 clearfix">
										<div class="col-xs-3 pad5 text-right">
											编号 :
										</div>
										<div class="col-xs-9 pad0">
											<p class="form-control" id="plan_id"></p>
											&lt;!&ndash;<input class="form-control" readonly="readonly" id="plan_id" />&ndash;&gt;
										</div>
									</div>
									<div class="mt10 clearfix">
										<div class="col-xs-3 pad5 text-right">
											预案名称 :
										</div>
										<div class="col-xs-9 pad0">
											<p class="form-control" id="plan_name"></p>
											&lt;!&ndash;<input class="form-control" id="plan_name" />&ndash;&gt;
										</div>
									</div>
									<div class="mt10 clearfix">
										<div class="col-xs-3 pad5 text-right">
											事故类型 :
										</div>
										<div class="col-xs-9 pad0">
											<p class="form-control" id="accident_name"></p>
											&lt;!&ndash;<input class="form-control" id="accident_name" />&ndash;&gt;
										</div>
									</div>
									<div class="mt10 clearfix">
										<div class="col-xs-3 pad5 text-right">
											预警级别 :
										</div>
										<div class="col-xs-9 pad0">
											<p class="form-control" id="accident_level"></p>										
											&lt;!&ndash;<input class="form-control" id="accident_class" />&ndash;&gt;
										</div>
									</div>
									<div class="mt10 clearfix">
										<div class="col-xs-3 pad5 text-right">
											预警类别 :
										</div>
										<div class="col-xs-9 pad0">
											<p class="form-control" id="accident_class"></p>
											&lt;!&ndash;<input class="form-control" id="accident_level" />&ndash;&gt;
										</div>
									</div>
									
									<div class="mt10 clearfix">
										<div class="col-xs-3 pad5 text-right">
											发布时间 :
										</div>
										<div class="col-xs-9 pad0">
											<p class="form-control" id="release_time"></p>
											&lt;!&ndash;<input class="form-control" id="release_time" />&ndash;&gt;
										</div>
									</div>
									<div class="mt10 clearfix">
										<div class="col-xs-3 pad5 text-right">
											使用次数 :
										</div>
										<div class="col-xs-9 pad0">
											<p class="form-control" id="release_num"></p>
											&lt;!&ndash;<input class="form-control" id="release_num" />&ndash;&gt;
										</div>
									</div>-->
								</div>					
								
							</div>
							<div class="col-xs-12 mt10" id="start_btn">
								<!--<button class="btn btn-success">启动</button>-->
							</div>
						</div>
					
				    </div>
					<!--案例库-->
					<div class="tab-pane fade comborder5" id="tab_list" style="width: 580px;">
						<div class="tl comtl">
							案例库<span class="close">x</span>
						</div>
						<div class="pad20 ind_cont font12 clearfix droptype">
							<div class="col-xs-6 workinput">
								<div class="clearfix">
									<div class="col-xs-3 pad5 text-right">
										事故类型 :
									</div>
									<div class="col-xs-9 pad0">
										<!--<input class="form-control" id="actiontype" />-->
										<div class="dropdown com_dropdown casetype" id="actiontype">
										    <button type="button" class="btn btn-block line-clamp"  data-toggle="dropdown">
										    	<span class="txt">请选择事故类型</span>
										        <span class="caret"></span>
										    </button>
										    <ul class="srcollcom dropdown-menu btn-block" role="menu"  style="max-height: 220px;">
										       
										    </ul>
										</div>
									</div>
								</div>
								<div class="mt10">
									<div class="col-xs-3 pad5 text-right">
										预警级别 :
									</div>
									<div class="col-xs-9 pad0">
										<!--<input class="form-control" id="worklevel" />-->
										<div class="dropdown com_dropdown caselevel" id="worklevel">
										    <button type="button" class="btn btn-block line-clamp"  data-toggle="dropdown">
										    	<span class="txt">请选择预警级别</span>
										        <span class="caret"></span>
										    </button>
										    <ul class="srcollcom dropdown-menu btn-block" role="menu"  style="max-height: 220px;">
										       
										    </ul>
										</div>
									</div>
								</div>							
							</div>
							<div class="col-xs-5 workinput" style="width: 38%;">
								<div class="clearfix">
									<div class="col-xs-4 pad5 text-right">
										预警类别 :
									</div>
									<div class="col-xs-8 pad0">
										<!--<input class="form-control" id="warnclass" />-->
										<div class="dropdown com_dropdown casewarn" id="warnclass">
										    <button type="button" class="btn btn-block line-clamp"  data-toggle="dropdown">
										    	<span class="txt">请选择预警类别</span>
										        <span class="caret"></span>
										    </button>
										    <ul class="srcollcom dropdown-menu btn-block" role="menu"  style="max-height: 220px;">
										       
										    </ul>
										</div>
									</div>								
								</div>	
								<!--<div class="mt10">
									<div class="col-xs-4 pad5 text-right">
										关键字 :
									</div>
									<div class="col-xs-8 pad0">
										<input class="form-control" id="casekey" />
									</div>								
								</div>				-->
							</div>
							<div class="col-xs-1" style="width: 12%;">
								<button class="btn btn-warning btn-xs btn_ind" onclick="queryCase()">查 询</button>
							</div>
							<div class="clearfix"></div>
							<div class="" id="works_info">
								<div class="col-xs-6 mt10" style="height: 300px;">
									<div class="case_control pad10 srcollcom" id="works_list" style="height: 300px!important;">
										<!--<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>
										<p>三防-江河洪(潮)水  Ⅳ级应急预案</p>-->
									</div>
								</div>
								<div class="col-xs-6 mt10">
									<div class="col-xs-3 pad5 text-right">
										事故类型 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="work_class"></p>
									</div>
								</div>
								<div class="col-xs-6 mt10">
									<div class="col-xs-3 pad5 text-right">
										预警类别 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="work_type"></p>
									</div>
								</div>
								<div class="col-xs-6 mt10">
									<div class="col-xs-3 pad5 text-right">
										预警级别 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="work_level"></p>
									</div>
								</div>
								<div class="col-xs-6 mt10">
									<div class="col-xs-3 pad5 text-right">
										报警号 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="work_num"></p>
									</div>
								</div>
								<div class="col-xs-6 mt10">
									<div class="col-xs-3 pad5 text-right">
										名称 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="work_name"></p>
									</div>
								</div>
								<div class="col-xs-6 mt10">
									<div class="col-xs-3 pad5 text-right">
										启动时间 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="work_time"></p>
									</div>
								</div>
								<div class="col-xs-6 mt10">
									<div class="col-xs-3 pad5 text-right">
										启动人 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="work_person"></p>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!--专家列表-->
					<div class="tab-pane fade comborder5" id="tab_spec" style="width: 580px;">
						<div class="tl comtl">
							专家列表<span class="close">x</span>
						</div>
						<div class="pad20 ind_cont font12 clearfix">							
							<div class="col-xs-6 case_control srcollcom" style="height: 470px;">
								<div class="" id="expert_list">
									<!--<div class="dialog1 warn_li pointer mb10">
										<div class="warn_li_tl colornum clearfix">
											类型：医疗急救
										</div>
										<div class="clearfix headimg">
											<div class="col-xs-4">
												<img src="../img/2_03.png" />
											</div>
											<div class="col-xs-8">
												<p>编号：ZJ001</p>
												<p>姓名：黄义久</p>
											</div>
										</div>
									</div>
									<div class="dialog1 warn_li pointer mb10">
										<div class="warn_li_tl colornum clearfix">
											类型：医疗急救
										</div>
										<div class="clearfix headimg">
											<div class="col-xs-4">
												<img src="../img/2_03.png" />
											</div>
											<div class="col-xs-8">
												<p>编号：ZJ001</p>
												<p>姓名：黄义久</p>
											</div>
										</div>
									</div>
									<div class="dialog1 warn_li pointer mb10">
										<div class="warn_li_tl colornum clearfix">
											类型：医疗急救
										</div>
										<div class="clearfix headimg">
											<div class="col-xs-4">
												<img src="../img/2_03.png" />
											</div>
											<div class="col-xs-8">
												<p>编号：ZJ001</p>
												<p>姓名：黄义久</p>
											</div>
										</div>
									</div>-->
								</div>
							</div>
							<div class="col-xs-6" id="expert_info">
								<div class="clearfix">
									<div class="col-xs-3 pad5 text-right">
										专家号 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_sn"></p>
									</div>
								</div>								
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										姓名 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_name"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										类型 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_type"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										性别 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_sex"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										民族 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_ethnic"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										机构 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_org"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										头衔 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_remarks"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										职位 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_position"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										描述 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_des"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										住址 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_addr"></p>
									</div>
								</div>
								<div class="clearfix mt10">
									<div class="col-xs-3 pad5 text-right">
										电话 :
									</div>
									<div class="col-xs-9 pad0">
										<p class="form-control" id="expert_mobile"></p>
									</div>
								</div>
							</div>
						</div>
					</div>
					
				</div>

				<div class="tab-pane fade comborder5 in active" id="case" style="width: 580px;height:450px;top:calc(50% - 225px);left: calc(50% - 290px);position: absolute;display: none;">
						<div class="tl comtl">
							参考案例
							<span class="close">x</span>
						</div>
						<div class="pad20 ind_cont font12 clearfix droptype">
							<div class="" id="info">
								<div class="col-xs-12" style="height: 400px;">
									<div class="pad10" style="height: 100%;overflow-y: auto;">
										<table class="table noborder" style="background-color: #093661;width: 100%;height: 350px;">

										</table>
									</div>

								</div>

							</div>
						</div>

				    </div>
				
				<!--右侧可伸缩操作台-->
				<div class="operat_nav">					
					<div class="btn_cont inblock fade_cont">
						<button class="ind_btn info_btn" id="wind_btn" >
								台风路径
						</button>
						<button class="ind_btn operat_btn" id="operat_btn1">
							决策辅助
							<ul class="ind_sed_btn nav">
								<li class="inblock active">
									<a href="#tab_case" data-toggle="tab">
										<div class="ind_nav_li">
											<i class="fa fa-file-text-o"></i>									
										</div>
										<p>预 案</p>									
									</a>
								</li>
								<li class="inblock">
									<a href="#tab_list" data-toggle="tab">
										<div class="ind_nav_li">
											<i class="fa fa-tasks"></i>									
										</div>
										<p>案 例</p>
									</a>
								</li>
								<li class="inblock">
									<a href="#tab_spec" data-toggle="tab">
										<div class="ind_nav_li">
											<i class="fa fa-user-secret"></i>									
										</div>
										<p>专 家</p>
									</a>
								</li>
							</ul>
						</button>
						
						<button class="ind_btn info_btn" id="info_btn1" >
								指挥调度							
						</button>
						<button class="ind_btn repository_btn" id="repository_btn1" >
								知识库							
						</button>
						<button class="ind_btn synthesis_btn" id="synthesis_btn1">
								综合查询
						</button>
						<button class="ind_btn synthesis_btn">
							<a href="http://172.27.162.39:666/Emergency/web/backend/pages/index_duty.html" target="_blank" id="command_btn1" style="color: #8eb7de">指挥调度</a>
						</button>
					</div>
					
					<button class="ind_btn ind_operat">
						<span class="fa fa-angle-left"></span> 操作台
					</button>
				</div>
				
				<!--视频图标hover对话框-->
				<div class="comborder5" id="dialog5" style="position: absolute;top: 50px;left: 500px;width: 300px;display: none;">
					<div class="border">
						<div class="dialog1">
							<div class="warn_li_tl colornum clearfix">
								ID：2019060600001001
							</div>
							<div class="warn_li_m pad5 line-clamp mt10">
								这里是视频图标hover对话框
							</div>
						</div>						
					</div>
				</div>
				
				<!--视频对话框-->
				<div class="ind_dialog comborder5" id="dialog4" style="position: absolute;left: 500px;top: 200px;display: none;">
					<div class="border">
						<span class="close pull-right">x</span>
						<div class="tl">
							视频监控
						</div>
						<div class="pad10" id="videoContent" style="overflow: hidden;">

						</div>
					</div>
				</div>
				<!--视频对话框-->
				<div class="ind_dialog comborder5" id="dialog7" style="position: absolute;left: 500px;top: 200px;display: none;">
					<div class="border">
						<span class="close pull-right">x</span>
						<div class="tl">
							视频监控
						</div>
						<div class="btnCont" style="margin-top: 10px">
							<div class="btn btn-warning" style="margin-left: 10px" onclick="clickCamera(1,0)">1</div>
							<div class="btn btn-warning" style="margin-left: 10px" onclick="clickCamera(4,1)">4</div>
							<div class="btn btn-warning" style="margin-left: 10px" onclick="clickCamera(9,4)">9</div>
						</div>
						<div class="pad10" id="videoContent1" style="overflow: hidden;">

						</div>
					</div>
				</div>

				<div class="ind_dialog comborder5" id="dialog8" style="position: absolute;right: 500px;top: 20px;display: none;width:380px;height:600px;">
					<div class="border">
						<span class="close pull-right">x</span>
						<div class="tl">
							物联总览
						</div>
						<table class="table table-bordered text-center" style="width: calc(100% - 20px);margin: 10px;">

						</table>
					</div>
				</div>

				<div class="ind_dialog comborder5" id="dialog9" style="position: absolute;width: 400px;left: calc(50% - 100px);top: calc(50% - 100px);min-height: 200px;display: none;">
					<div class="border">
						<span class="close pull-right">x</span>
						<div class="tl">
							路线查询
						</div>
						<div class="pad10" style="margin-top: 20px;">
							<div id="resultDiv"></div>
						</div>
					</div>
				</div>
				<div class="ind_dialog comborder5" id="dialog10" style="position: absolute;width: 400px;left: calc(50% - 100px);top: calc(50% - 100px);min-height: 200px;display: none;">
					<div class="border">
						<span class="close pull-right">x</span>
						<div class="tl">
							路线查询
						</div>
						<div class="pad10" style="margin-top: 20px;">
							<div id="resultDiv1"></div>
						</div>
					</div>
				</div>
				<div class="ind_dialog comborder5" id="wind_panel" style="width: 660px;position: absolute;left: calc(50% - 330px);top: calc(50% - 265px);display: none;">
					<div class="tl comtl">
						台风路径<span class="close">x</span>
					</div>
					<iframe frameborder="0" width="650" height="488" src="http://typhoon.weather.com.cn/gis/typhoon_p.shtml" name="surf" scrolling="no"></iframe>
				</div>

				<div class="ind_dialog comborder5" id="dialog6" style="position: absolute;width: 450px;left: calc(50% - 200px);top: calc(50% - 250px);height: 500px;display: none;">
					<div class="border">
						<span class="close pull-right">x</span>
						<div class="tl">
							综合搜索
						</div>
						<div class="pad10" style="margin-top: 20px;">
							<form action="" class="form-inline">
								<div class="layui-form-item" style="margin-bottom:25px;">
									<div class="col-xs-12">
										<label class="form-label col-xs-3" style="margin-top: 7px;text-align: center;">类别：</label>
										<select class="form-control col-xs-9" style="border-radius: 0;background-color: #093661;color: white;width: 75%;" id="mapType">
											<option>请选择类别</option>
											<option value="1">摄像头</option>
											<option value="2">应急队伍</option>
											<option value="3">应急车辆</option>
											<option value="4">应急装备</option>
											<option value="5">消防栓</option>
											<option value="6">健康小屋</option>
											<option value="7">特殊人群</option>
											<option value="8">智慧路灯</option>
											<option value="9">水质检测</option>
											<option value="10">水雨情</option>
											<option value="11">AQI</option>
											<option value="12">行为识别</option>
											<option value="13">两违分析</option>
											<option value="14">客流量</option>
											<option value="15">人脸分析</option>
										</select>
									</div>
								</div>
								<div class="layui-form-item" style="margin-bottom:25px;">
									<div class="col-xs-12">
										<label class="form-label col-xs-3" style="margin-top: 7px;text-align: center;">名称：</label>
										<input class="layui-input col-xs-9" style="background-color: #093661;color: white;width: 75%;" id="mapName" placeholder="请输入设备名称">
									</div>
								</div>
								<div class="layui-form-item" style="margin-bottom:25px;">
									<div class="col-xs-12">
										<label class="form-label col-xs-3" style="margin-top: 7px;text-align: center;">状态：</label>
										<select class="form-control col-xs-9" style="border-radius: 0;background-color: #093661;color: white;width: 75%;" id="mapStatus">
											<option>请选择设备状态</option>
											<option value="1">正常</option>
											<option value="0">故障</option>
										</select>
									</div>
								</div>
								<div class="layui-form-item" style="margin-bottom:25px;">
									<div class="col-xs-12">
										<label class="form-label col-xs-3" style="margin-top: 7px;text-align: center;">半径：</label>
										<select class="form-control col-xs-9" style="border-radius: 0;background-color: #093661;color: white;width: 75%;" id="mapRadius">
											<option>请选择查询半径</option>
											<option value="1">500米</option>
											<option value="2">1公里</option>
											<option value="3">2公里</option>
											<option value="4">4公里</option>
											<option value="5">10公里</option>
											<option value="6">不限</option>
										</select>
									</div>
								</div>
								<div class="layui-form-item">
									<div id="submitBox" class="col-xs-6 col-xs-offset-3" style="text-align: center;">
										<div class="layui-btn" id="mapSubmit">查询</div>
										<div class="layui-btn layui-btn-warm" id="mapCancel">取消</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script type="text/javascript" src="../js/layer_v3.1.1/layer.js" ></script>
		<script>
			layui.use(['form', 'layedit', 'laydate'], function() {
                var form = layui.form;
                form.render()
				form.on('checkbox(camera)', function(data){
				    console.log(data); //得到checkbox原始DOM对象
				  	console.log(data.elem.checked); //是否被选中，true或者false
				});
                form.on('checkbox(goods)', function(data){
				    console.log(data); //得到checkbox原始DOM对象
				  	console.log(data.elem.checked); //是否被选中，true或者false
				});
                form.on('checkbox(equipment)', function(data){
				    console.log(data); //得到checkbox原始DOM对象
				  	console.log(data.elem.checked); //是否被选中，true或者false
				});
                form.on('checkbox(expert)', function(data){
				    console.log(data); //得到checkbox原始DOM对象
				  	console.log(data.elem.checked); //是否被选中，true或者false
				});
                form.on('checkbox(watchman)', function(data){
				    console.log(data); //得到checkbox原始DOM对象
				  	console.log(data.elem.checked); //是否被选中，true或者false
				});
                form.on('checkbox(team)', function(data){
				    console.log(data); //得到checkbox原始DOM对象
				  	console.log(data.elem.checked); //是否被选中，true或者false
				});
                form.on('checkbox(emphasis)', function(data){
				    console.log(data); //得到checkbox原始DOM对象
				  	console.log(data.elem.checked); //是否被选中，true或者false
				});
            })

			$("#wind_btn").on("click",function(){
			     $("#wind_panel").show();
			})

			$(document).ready(function(){
				$(".mapMenu").click(function(e){
				    console.log(1);
					if($(this).parents(".ind_nav_st").hasClass("active")){
						$(this).parents(".ind_nav_st").removeClass("active");
						return;
					}
					$(this).parents(".ind_nav_st").addClass("active")
				})
				$(".ind_nav_sec").on("click",'a .ind_nav_li',function(e){
				    e.stopPropagation();
				    if($(this).hasClass("active")){
				        removeMapIcon($(this).attr("id"));
				        $(this).removeClass("active");
				        return;
					}
				    $(this).addClass("active");
				})
//				关闭决策辅助弹窗
				$("#operat_dia .close").click(function(){
					$("#operat_dia").hide();
					$(".operat_btn").removeClass("active")
				})

				$(".check_list").click(function(){
				    if($(this).find(".fa").hasClass("fa-check-square-o")){
                        switch(parseInt($(this).parents("tr").index())){
                            case 1:
                                removeMapIcon("team");
                                break;
                            case 4:
                                removeMapIcon("camera");
                                break;
                            case 5:
                                removeMapIcon("equipment");
                                break;
                        }
					}else{
				        getMapIcon($(this).parents("tr").index())
					}
                    $(this).find(".fa").toggleClass("fa-check-square-o").toggleClass("fa-square-o")
                })
				$(".close").on('click',function(){
				    $(this).parents(".ind_dialog").hide();
				})
			})
				var EArr=[0,0,0,0,0,0,0,0,0,0,0,0,0] 
				var EArr1=[[],[],[],[],[],[],[],[],[],[],[],[],[]];
				var cameraJSON;
				var editData=[];
				var contactLayer;

				$.getJSON('../js/page/camera.json',function(data){
				    cameraJSON=data;
				    console.log(data);
				})
				var unevenindex,planindex;
//				未处理事件列表
				$("#unevenbtn").on("click", function() {
				    clearInterval(sound);
				    unevenindex=layer.open({
				    	type: 2,
				    	id:"uneventlist",
						offset: ['100px', '340px'],
						shade: false,
						closeBtn: 2,
						fixed:false,
						title:false,
						area: ['340px', '500px'],
						skin: '',
						moveType:1,
						content: 'ind_uneventlist.html',
						end:function(){
				    	    unevenindex=null;
						}
					})
					layer.close(planindex)
				})

//				操作台事件
				var pane1,pane2,pane3,pane4,pane5,pane6;
//				决策辅助弹出框
				
				$(".operat_btn").click(function(){
					$("#operat_dia").removeClass("operatpos")
					if($(this).hasClass("active")){
						return
					}
					$(".btn_cont .ind_btn").removeClass("active")
					$(this).addClass("active")
					$("#operat_dia").show();
					
					layer.close(pane1);layer.close(pane2);layer.close(pane3);
					layer.close(pane4);layer.close(pane5);layer.close(pane6);
				})
				$("#operat_btn2").click(function(){
					$("#operat_dia").addClass("operatpos")
				})
				$(".ind_sed_btn li").click(function(){
//					$(".ind_sed_btn li").removeClass("active");
//					$(".ind_sed_btn li").eq($(this).index()).attr("class","inblock active")
//					$(this).addClass("active");
				})
//				知识库弹出框
				$("#repository_btn1").on("click", function() {
					if($(this).hasClass("active")){
				    	$(this).removeClass("active")
				    	layer.close(pane2);
						return
					}
					$(".btn_cont .ind_btn").removeClass("active")
					$(this).addClass("active")
					$("#operat_dia").hide();
					layer.close(pane1);layer.close(pane3);
					layer.close(pane4);layer.close(pane5);layer.close(pane6);
					
				    pane2=layer.open({
				    	type: 2,
				    	id:"repository1",
						offset: 'auto',
						shade: false,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['580px', '540px'],
						skin: '',
						content: 'ind_repository.html'
					})
				    
				})

//				综合查询弹出框
				$("#synthesis_btn1").on("click", function() {
					if($(this).hasClass("active")){
				    	$(this).removeClass("active");
				    	layer.close(pane3);
						return
					}
					$(".btn_cont .ind_btn").removeClass("active");
					$(this).addClass("active");
					$("#operat_dia").hide();

					$(".operat_btn").removeClass("active");
					layer.close(pane1);layer.close(pane2);
					layer.close(pane4);layer.close(pane5);layer.close(pane6);
					
				    pane3=layer.open({
				    	type: 2,
				    	id:"synthesis1",
						offset: 'auto',
						shade: false,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['750px', '600px'],
						skin: '',
						content: 'ind_query.html'
					})
				})
//				指挥调度弹出框
				$("#info_btn1").on("click", function() {
					if($(this).hasClass("active")){
				    	$(this).removeClass("active")
				    	layer.close(pane1);
						return
					}
					$(".btn_cont .ind_btn").removeClass("active")
					$(this).addClass("active")
					$("#operat_dia").hide();
					layer.close(pane2);layer.close(pane3);
					layer.close(pane4);layer.close(pane5);layer.close(pane6);
					
				    pane1=layer.open({
				    	type: 2,
				    	id:"infocont1",
						offset: 'auto',
						shade: false,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['445px', '302px'],
						skin: '',
						content: 'ind_info.html',
						end:function(){
				    	    pane1 = null;
						}
					})
					
				})
				
//				知识库弹出框
				$("#repository_btn2").on("click", function() {
					if($(this).hasClass("active")){
				    	$(this).removeClass("active")
				    	layer.close(pane5);
						return
					}
					$(".btn_cont .ind_btn").removeClass("active")
					$(this).addClass("active")
					$("#operat_dia").hide();
					layer.close(pane1);layer.close(pane2);layer.close(pane3);
					layer.close(pane4);layer.close(pane6);
					
				    pane5=layer.open({
				    	type: 2,
				    	id:"repository2",
						offset: ['110px', '1330px'],
						shade: false,
						closeBtn: 2,
						fixed:false,
						title:false,
						area: ['580px', '540px'],
						skin: '',
						moveType:1,
						content: 'ind_repository.html'
					})
				    
					
				})

//				综合查询弹出框
				$("#synthesis_btn2").on("click", function() {
					if($(this).hasClass("active")){
				    	$(this).removeClass("active")
				    	layer.close(pane6);
						return
					}
					$(".btn_cont .ind_btn").removeClass("active")
					$(this).addClass("active")
					$("#operat_dia").hide();

					$(".operat_btn").removeClass("active")
					layer.close(pane1);layer.close(pane2);layer.close(pane3);
					layer.close(pane4);layer.close(pane5);
					
				    pane6=layer.open({
				    	type: 2,
				    	id:"synthesis2",
						offset: ['570px', '750px'],
						shade: false,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['640px', '463px'],
						skin: '',
						content: 'ind_query.html'
					})
				})
//				指挥调度弹出框
				$("#info_btn2").on("click", function() {
					if($(this).hasClass("active")){
				    	$(this).removeClass("active")
				    	layer.close(pane4);
						return
					}
					$(".btn_cont .ind_btn").removeClass("active")
					$(this).addClass("active")
					$("#operat_dia").hide();
					layer.close(pane1);layer.close(pane2);layer.close(pane3);
					layer.close(pane5);layer.close(pane6);
					
				    pane4=layer.open({
				    	type: 2,
				    	id:"infocont2",
						offset: ['110px', '1330px'],
						shade: false,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['445px', '302px'],
						skin: '',
						content: 'ind_info.html',
						end:function(){
				    	    pane4 = null;
						}
					})
				})

//				关闭操作台
				$(".ind_operat").on("click", function() {
//					$("#operat_dia").find(".tab-pane").removeClass("in active");

					$("#operat_dia").hide()

					$(".operat_btn").removeClass("active")
					$(".fade_cont").fadeToggle(300)
					$(this).find(".fa").toggleClass("fa-angle-right");
					
					layer.close(pane1);layer.close(pane2);layer.close(pane3);
					layer.close(pane4);layer.close(pane5);layer.close(pane6);
				})


//				应急值守人员

				$("#watchman_btn").on("click", function() {
					index1=layer.open({
						type: 2,
						id:"watchman",
						shade: 0.3,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['600px', '400px'],
						content: 'ind_watchman.html'
					})
				})
				$("#specialist_btn").on("click", function() {
				    index1=layer.open({
				    	type: 2,
				    	id:"specialist",
						shade: 0.3,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['600px', '400px'],
						content: 'ind_special.html'
					})
				})
			function changeTime(){
                var date=new Date();
                $("#time").text(prefixInteger(date.getHours(),2)+":"+prefixInteger(date.getMinutes(),2)+":"+prefixInteger(date.getSeconds(),2));
                $("#week").text(weekday(date.getDay())+" "+date.getFullYear()+"/"+prefixInteger(date.getMonth()+1,2)+"/"+prefixInteger(date.getDate(),2));
            }
            setInterval(changeTime,1000);
			$.ajax({
				url:'https://api.caiyunapp.com/v2/Y2FpeXVuIGFwaSB3ZWI/113.8998,23.4232/realtime.jsonp?callback=MYCALLBACK',
				dataType:'jsonp',
				type:'get'
			})
			function MYCALLBACK(data){
			    var weaStr;
			    var iconStr;
			    switch (data.result.skycon) {
					case "CLEAR_DAY":
					    weaStr= "晴天";
					    iconStr="../img/weather/sunny.png";
					    break;
					case "CLEAR_NIGHT":
					    weaStr= "晴夜";
					    iconStr="../img/weather/sunnyN.png";
					    break;
					case "PARTLY_CLOUDY_DAY":
					    weaStr= "多云";
					    iconStr="../img/weather/cloudy.png";
					    break;
					case "PARTLY_CLOUDY_NIGHT":
					    weaStr= "多云";
						iconStr="../img/weather/cloudyN.png";
					    break;
					case "CLOUDY":
					    weaStr= "阴";
						iconStr="../img/weather/cloudy.png";
					    break;
					case "RAIN":
					    weaStr= " 雨";
						iconStr="../img/weather/rain.png";
					    break;
					case "SNOW":
					    weaStr= " 雪";
						iconStr="../img/weather/snow.png";
					    break;
					case "WIND":
					    weaStr= " 风";
						iconStr="../img/weather/wind.png";
					    break;
					case "HAZE":
					    weaStr= " 雾霾沙尘";
						iconStr="../img/weather/haze.png";
					    break;
                }
                $("#weather").text(weaStr+" "+parseInt(data.result.temperature)+"℃");
                $(".weath .icon img").attr("src",iconStr);
			}

//			默认第一条报警号的预案

			var eventId,planId,typeId,actionId;
			
			function getfirst(){
				var data=JSON.parse(sessionStorage.getItem("data")).data[0];
				var aId=data.actionProgramId;
				sessionStorage.setItem("nowCenter",JSON.stringify(data.location));
				eventId=data.eventId;
				levelId=data.warnLevelId;
				typeId=data.warnTypeId;
				actionId=data.actionProgramId
				planId="";

				$("#tab_case").find("#caseid").text(data.eventId);

				if(data.actionProgramId==null){
					$("#start_btn").html('<button class="btn btn-success" onclick="enabledplan()">预案详情</button>');
				}else{
//					$("#start_btn").html('<button class="btn btn-success" onclick="enabledplan()">预案详情</button>');
					$("#start_btn").html('<button class="btn btn-info sclose">结案</button>');
				}
	            $("#case_list").empty();

	            $.ajax({
					url:'/dispatch/center/queryPlan',
					dataType:'json',
					type:'post',
					data:{
						"levelId":data.warnLevelId,
					},
					success:function(result){
						planData=result.data;
						if(result.data.length<1){
							$("#case_list").html("<p>暂无相关预案数据...</p>");
							return false;
						}
						$.each(result.data,function(idx,item){
							$("#case_list").append("<p onclick='getplan(\""+item.id+"\",this)'>"+item.name+"</p>");
						});
					}
				})

//				默认案例库列表
				getcaseList(0)

				getexpertList();

				$("#LogList").empty();
				$.ajax({
                    url: '/dispatch/center/getTaskLog/'+aId,
                    type: 'post',
                    dataType: 'json',
                    success: function (data) {
						for(var i in data.data){
						    if(i==0){
						        $("#LogList").append("<div class='dialog1 warn_li'><div class='warn_li_tl colornum clearfix'>"+data.data[i].time+"</div>"+
                            						"<div class='warn_li_m pad5 line-clamp mt10' title='"+data.data[i].content+"'>"+data.data[i].content+"</div></div>")
							}else{
						        $("#LogList").append("<div class='dialog1 warn_li mt10'><div class='warn_li_tl colornum clearfix'>"+data.data[i].time+"</div>"+
                            						"<div class='warn_li_m pad5 line-clamp mt10' title='"+data.data[i].content+"'>"+data.data[i].content+"</div></div>")
							}
						}
                    }
                })
			}

			var levelId;
			var planData;
			var caseData;
			var aId;
			$("#planList").on("click",'.dialog1',function(e){
			    $("#plantlist").parent(".layui-layer-iframe").hide();
			    layer.close(unevenindex);
			    var index=$(this).index();
			    var s=new Scroll($("#planList"));
				s.stop();
			    sessionStorage.setItem("nowIndex",index);
			    var data=JSON.parse(sessionStorage.getItem("data")).data[index];
			    sessionStorage.setItem("nowCenter",JSON.stringify(data.location));
			    sessionStorage.setItem("actionId",data.actionProgramId);
                sessionStorage.setItem("appactionId", data.actionProgramId);//添加app反馈任务的方案id
			    aId=data.actionProgramId;
			    beforeOpen();

				//加载预警信息开始
                    showEventInfo(data);
                    $("#operat_dia .active").show();
                    $("#dialog8").hide();
                    $(".operat_nav").animate({
						right:'400px',
						top:'20px'
					},1500);
					$(".ind_nav").animate({
						right:'400px'
					},1500);
					$("#rightPanel").fadeIn(1500);
				//TODO 显示周边(暂时查询所有，不按地理距离查询)
				showArround($(this).attr("dataId"));
            	getSimilarCase(data.eventId);
            	getWarnCenter(data);
            	sessionStorage.setItem("planId",data.dispatchPlanmainId?data.dispatchPlanmainId:'');
				//预案查询开始
				eventId=data.eventId;
				planId="";

				$("#tab_case").find("#caseid").text(eventId);
            	$("#case_list").empty();
            	$("#tab_case input").val("");
            	$("#tabinfo .form-control").text("");

				if(data.actionProgramId==null){
					$("#start_btn").html('<button class="btn btn-success" onclick="enabledplan()">预案详情</button>');
				}else{
					$("#start_btn").html('<button class="btn btn-info sclose">结案</button>');
				}
            	levelId=data.warnLevelId

				$.ajax({
					url:'/dispatch/center/queryPlan',
					dataType:'json',
					type:'post',
					data:{
						"levelId":levelId,
					},
					success:function(result){
						console.log(result)
						planData=result.data;
						if(planData.length<1){
							$("#case_list").html("<p>暂无相关预案数据...</p>");
							return false;
						}
						$.each(result.data,function(idx,item){
							$("#case_list").append("<p onclick='getplan(\""+item.id+"\",this)'>"+item.name+"</p>");
						});
					}
				})

//				根据预警id获取案列库列表
				getcaseList(index);
//				专家列表
				typeId=data.warnTypeId;
				getexpertList();
				loadRes(index);
				loadLog(data.eventState);
				loadStep(aId);

				$("#relocate").on('click',function(){
				    swal({
                        title: "温馨提示",
                        text: "请在地图上（非半径圈内）点击选择一个点",
                        type: "success",
						timer:3000
                    })
				    sessionStorage.setItem("beforeIndex",$("#planList .active").index());
				    relocate(eventId);
				})
				$(".casetype").find(".txt").text("请选择事故类型");
				$(".caselevel").find(".txt").text("请选择预警类别");
				$(".casewarn").find(".txt").text("请选择预警级别");
            })
			
			
//			报警事件下拉选项
			var warnmenudata=[],levelmenudata=[];
			function downoption(){
				var eventmenu=$(".casetype").find(".dropdown-menu");
				eventmenu.empty()
				
				eventmenu.append("<li><a onclick='casetype(this)'>请选择事故类型</a></li>");
				$.ajax({
					url:'/planManage/planMain/getSelectData',
					dataType:'json',
					type:'post',
					success:function(result){
						console.log(result)
						$.each(result.accidentTypeList,function(idx,item){
							eventmenu.append("<li><a onclick='casetype(this)'>"+item.name+"</a></li>");
						})
						warnmenudata=result.earlywarnTypeList;
						levelmenudata=result.earlywarnLevelList;
						
					}
				})
			}
			
			function casetype(opt){
				var eventtypetxt=$(opt).parents(".dropdown").find(".txt");
				eventtypetxt.text($(opt).text());
				var warnmenu=$(opt).parents(".droptype").find(".casewarn");
				var levelmenu=$(opt).parents(".droptype").find(".caselevel");
				warnmenu.find(".txt").text("请选择预警类别");
				levelmenu.find(".txt").text("请选择预警级别");
				warnmenu.find(".dropdown-menu").empty();
				levelmenu.find(".dropdown-menu").empty();
				
				warnmenu.find(".dropdown-menu").append("<li><a onclick='casewarn(this)'>请选择预警类别</a></li>");				
				$.each(warnmenudata,function(idx,item){
					if(item.accidentTypeName==eventtypetxt.text()){
						warnmenu.find(".dropdown-menu").append("<li><a onclick='casewarn(this)'>"+item.name+"</a></li>");						
					}
				})
			}
			function casewarn(opt){
				var warntypetxt=$(opt).parents(".dropdown").find(".txt");
				warntypetxt.text($(opt).text());
				var levelmenu=$(opt).parents(".droptype").find(".caselevel");
				levelmenu.find(".txt").text("请选择预警级别");				
				levelmenu.find(".dropdown-menu").empty();
				
				levelmenu.find(".dropdown-menu").append("<li><a onclick='caselevel(this)'>请选择预警级别</a></li>");
				$.each(levelmenudata,function(idx,item){
					if(item.earlywarnTypeName==warntypetxt.text()){
						levelmenu.find(".dropdown-menu").append("<li><a onclick='caselevel(this)'>"+item.name+"</a></li>");						
					}
				})
			}
			function caselevel(opt){
				var warnleveltxt=$(opt).parents(".dropdown").find(".txt");
				warnleveltxt.text($(opt).text());				
			}
				function loadLog(type){
			    	//处理日志查询开始
					$("#LogList").empty();
					if(type!=1){
                        var aId1=(aId==null?localStorage.getItem("action"):aId);
                        $.ajax({
                            url: '/dispatch/center/getTaskLog/'+aId1,
                            type: 'post',
                            dataType: 'json',
                            success: function (data) {
                                for(var i in data.data){
                                    if(i==0){
                                        $("#LogList").append("<div class='dialog1 warn_li'><div class='warn_li_tl colornum clearfix'>"+data.data[i].time+"</div>"+
                                            "<div class='warn_li_m pad5 line-clamp mt10' title='"+data.data[i].content+"'>"+data.data[i].content+"</div></div>")
                                    }else{
                                        $("#LogList").append("<div class='dialog1 warn_li mt10'><div class='warn_li_tl colornum clearfix'>"+data.data[i].time+"</div>"+
                                            "<div class='warn_li_m pad5 line-clamp mt10' title='"+data.data[i].content+"'>"+data.data[i].content+"</div></div>")
                                    }
                                }
                            }
                        })
					}else{
					    $.ajax({
                            url: '/dispatch/center/getTaskLog/'+null,
                            type: 'post',
                            dataType: 'json',
                            success: function (data) {
                                for(var i in data.data){
                                    if(i==0){
                                        $("#LogList").append("<div class='dialog1 warn_li'><div class='warn_li_tl colornum clearfix'>"+data.data[i].time+"</div>"+
                                            "<div class='warn_li_m pad5 line-clamp mt10' title='"+data.data[i].content+"'>"+data.data[i].content+"</div></div>")
                                    }else{
                                        $("#LogList").append("<div class='dialog1 warn_li mt10'><div class='warn_li_tl colornum clearfix'>"+data.data[i].time+"</div>"+
                                            "<div class='warn_li_m pad5 line-clamp mt10' title='"+data.data[i].content+"'>"+data.data[i].content+"</div></div>")
                                    }
                                }
                            }
                        })
					}

				}


                function showEventInfo(data){
                    $("#d2t").empty();
                    $("#operat_dia .table").empty();
                    $("#d2t").append("<tr><td width='100px'>事件摘要：</td><td>"+(data.eventDesc?data.eventDesc:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>事件摘要：</td><td>"+(data.eventDesc?data.eventDesc:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>事件类型：</td><td>"+(data.eventType?data.eventType:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>事件类型：</td><td>"+(data.eventType?data.eventType:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>预警类别：</td><td>"+(data.warnType?data.warnType:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>预警类别：</td><td>"+(data.warnType?data.warnType:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>预警级别：</td><td>"+(data.warnLevel?data.warnLevel:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>预警级别：</td><td>"+(data.warnLevel?data.warnLevel:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>地点：</td><td>"+(data.address?data.address:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>地点：</td><td>"+(data.address?data.address:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>经纬度：</td><td>"+(data.location?(data.location.lon+","+data.location.lat):'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>经纬度：</td><td>"+(data.location?(data.location.lon+","+data.location.lat):'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>报告单位：</td><td>"+(data.repDept?data.repDept:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>报告单位：</td><td>"+(data.repDept?data.repDept:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>报告人：</td><td>"+(data.repName?data.repName:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>报告人：</td><td>"+(data.repName?data.repName:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>报告时间：</td><td>"+(data.repTime?data.repTime:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>报告时间：</td><td>"+(data.repTime?data.repTime:'')+"</td></tr>");
                    $("#d2t").append("<tr><td width='100px'>报告电话：</td><td>"+(data.repPhone?data.repPhone:'')+"</td></tr>");
                    $("#operat_dia .table").append("<tr><td width='100px'>报告电话：</td><td>"+(data.repPhone?data.repPhone:'')+"</td></tr>");
                }
                //			查询预案
			function queryPlan(){
				var eventtype=$("#event_type").find(".txt").text()=="请选择事故类型"?"":$("#event_type").find(".txt").text();
				var warntype=$("#warn_type").find(".txt").text()=="请选择预警类别"?"":$("#warn_type").find(".txt").text();
				var warnlevel=$("#warn_level").find(".txt").text()=="请选择预警级别"?"":$("#warn_level").find(".txt").text();
			
				
//          	$("#tab_case input").val("");
				$("#plan_id").text("");
				$("#plan_name").text("");
				$("#accident_name").text("");
				$("#accident_class").text("");
				$("#accident_level").text("");
				$("#release_time").text("");
				$("#release_num").text("");
				planId="";

				$.ajax({
					url:'/dispatch/center/queryPlan',
					dataType:'json',
					type:'post',
					data:{
						"levelId":levelId,
						"accidentName":eventtype,
						"warnTypeName":warntype,
						"warnLevelName":warnlevel
					},
					success:function(result){
						planData=result.data;
						$("#case_list").empty();
						if(planData.length<1){
							$("#case_list").html("<p>暂无相关预案数据...</p>");
							return false;
						}
						$.each(result.data,function(idx,item){
							$("#case_list").append("<p onclick='getplan(\""+item.id+"\",this)'>"+item.name+"</p>");
						});
					}
				})
			}
//			获取预案信息
			function getplan(key,p){
				$("#case_list p").removeClass("colorblue");
				$(p).addClass("colorblue");
				console.log(planData)
				$.each(planData,function(idx,value) {
					if(value.id==key){
						planId=value.id;
						$("#plan_id").text(value.code);
						$("#plan_name").text(value.name);
						$("#accident_name").text(value.accidentTypeName);
						$("#accident_class").text(value.earlywarnLevelName);
						$("#accident_level").text(value.earlywarnTypeName);
//						$("#release_time").text(value.updateDate);
						$("#release_time").text(value.updateDate==null?"":value.updateDate);

//						$("#release_num").text(value.useTime);
						$("#release_num").text(value.useTime==null?"":value.useTime);

						return false;
					}
			    });
			}

//				获取案例库列表
			function getcaseList(index){
				/*$("#works_info").find(".form-control").text("");*/
				$("#caseTable").empty();
				/*$(".workinput input").val("")*/

				$.ajax({
					url:'/dispatch/center/getArchiveCase',
					dataType:'json',
					type:'get',
					data:{
						"accidentName":JSON.parse(sessionStorage.getItem("data")).data[index].eventType,
						"warnTypeName":JSON.parse(sessionStorage.getItem("data")).data[index].warnType,
						"warnLevelName":JSON.parse(sessionStorage.getItem("data")).data[index].warnLevel
					},
					success:function(result){
						caseData=result.data;
						console.log(caseData.length)
						if(caseData.length<1){
							$("#caseTable").html("<p>暂无相关案例数据...</p>");
							return false;
						}
						$.each(caseData,function(idx,item){
						    console.log(idx)
							$("#caseTable").append("<p onclick='getcaseInfo(\""+item.id+"\",this)'>"+item.planName+"</p>");
						});
					}
				})
			}
//			案例库查询
			function queryCase(){
//				var actiontype=$("#actiontype").val().trim();
//				var warnclass=$("#warnclass").val().trim();
//				var worklevel=$("#worklevel").val().trim();

				var actiontype=$("#actiontype").find(".txt").text()=="请选择事故类型"?"":$("#actiontype").find(".txt").text();
				var warnclass=$("#warnclass").find(".txt").text()=="请选择预警类别"?"":$("#warnclass").find(".txt").text();
				var worklevel=$("#worklevel").find(".txt").text()=="请选择预警级别"?"":$("#worklevel").find(".txt").text();
			
				$("#works_list").empty();
				$("#works_info").find(".form-control").text("");

				$.ajax({
					url:'/dispatch/center/getCaseByLost',
					dataType:'json',
					type:'post',
					data:{
						"accidenName":actiontype,
						"warnTypeName":warnclass,
						"warnLevelName":worklevel
					},
					success:function(result){
						caseData=result.data;
						if(caseData.length<1){
							$("#works_list").html("<p>暂无相关案例数据...</p>");
							return false;
						}
						$.each(caseData,function(idx,item){
							$("#works_list").append("<p onclick='getcaseInfo(\""+item.id+"\",this)'>"+item.planName+"</p>");
						});
					}
				})
			}
//			获取案例库信息
			function getcaseInfo(key,p){
				$("#works_list p").removeClass("colorblue");
				$(p).addClass("colorblue");
//				console.log(caseData)
				/*$.each(caseData,function(idx,value) {
					if(value.id==key){
						$("#work_class").text(value.accidentName);
						$("#work_type").text(value.warnTypeName);
						$("#work_level").text(value.warnLevelName);
						$("#work_num").text(value.warnId);
						$("#work_name").text(value.planName);
						$("#work_time").text(value.action_date);
						$("#work_person").text(value.actionPerson);

						return false;
					}
			    });*/
				$.ajax({
					url:'/dispatch/center/getArchiveCaseDetails',
					dataType:'json',
					type:'get',
					data:{
					    'archiveActionprogramId':key
                    },
					success:function(data){
					    $("#case").show();
					    $("#case .table").empty();
						$("#case .table").append("<tr><td width='100px'>事件摘要：</td><td>"+(data.data.archivePlanMain.startCondition?data.data.archivePlanMain.startCondition:'')+"</td></tr>");
						$("#case .table").append("<tr><td width='100px'>事件类型：</td><td>"+(data.data.archivePlanMain.accidentTypeName?data.data.archivePlanMain.accidentTypeName:'')+"</td></tr>");
						$("#case .table").append("<tr><td width='100px'>预警类别：</td><td>"+(data.data.archivePlanMain.earlywarnTypeName?data.data.archivePlanMain.earlywarnTypeName:'')+"</td></tr>");
						$("#case .table").append("<tr><td width='100px'>预警级别：</td><td>"+(data.data.archivePlanMain.earlywarnLevelName?data.data.archivePlanMain.earlywarnLevelName:'')+"</td></tr>");
						$("#case .table").append("<tr><td width='100px'>报告单位：</td><td>"+(data.data.archivePlanMain.startDeptName?data.data.archivePlanMain.startDeptName:'')+"</td></tr>");
						$("#case .table").append("<tr><td width='100px'>结束时间：</td><td>"+(data.data.archiveActionprogram.closecaseDate?data.data.archiveActionprogram.closecaseDate:'')+"</td></tr>");
					}
				})
			}

//			启动预案
			var layerstart;
			function enabledplan(){
				if(planId==""){
//					alert("请选择预案")
//					swal("请选择预案","","warning");
					parent.layer.msg('请选择预案！');
					return false;
				}
				layerstart=parent.layer.open({
			    	type: 2,
			    	id:"taskstart",
					shade: 0.3,
					closeBtn: 2,
					fixed:false,
					moveType:1,
					title:false,
					moveType:1,
					area: ['880px', '626px'],
					content: 'ind_start.html'
				})
//				$.ajax({
//					url:'/dispatch/center/startAction',
//					dataType:'json',
//					type:'post',
//					data:{
//						"eventId":eventId,
//						"planId":planId
//					},
//					success:function(result){
//						if(result.msg!="操作成功"){
////							alert("操作失败");
//							swal("操作失败","","warning");
//							return
//						}else{
//							$("#start_btn").html('<button class="btn btn-info sclose">结案</button>');
//						}
//					}
//				})
			}


//			获取专家列表
			var expertData;
			function getexpertList(){
            	$("#expert_list").empty()
            	$("#expert_info .form-control").text("");
//				levelId="";
				$.ajax({
					url:'/dispatch/center/expert/query',
					dataType:'json',
					type:'post',
					data:{
						"warnId":typeId
					},
					success:function(result){
//						console.log(result)
						expertData=result.data;
						if(result.data.length==0){
							$("#expert_list").html("暂无专家数据...");
							return false;
						}
						$.each(result.data,function(idx,item){
							$("#expert_list").append('<div class="dialog1 warn_li pointer mb10" onclick="getexpertInfo(\''+item.RN+'\',this)">'+
								'<div class="warn_li_tl colornum clearfix">'+
									'类型：'+item.earlywarnName+''+
								'</div>'+
								'<div class="clearfix headimg">'+
									'<div class="col-xs-4">'+
										'<img src="../img/2_03.png" />'+
									'</div>'+
									'<div class="col-xs-8">'+
										'<p>编号：'+item.sn+'</p>'+
										'<p>姓名：'+item.name+'</p>'+
									'</div>'+
								'</div>'+
							'</div>');
						});
					}
				})
			}

			function getexpertInfo(key,ele){
				$("#expert_list .warn_li").removeClass("active");
            	$("#expert_info .form-control").text("");
				$(ele).addClass("active");
				$.each(expertData,function(idx,value) {
					if(value.RN==key){
						$("#expert_sn").text(value.sn);
						$("#expert_name").text(value.name);
						$("#expert_type").text(value.typeof);					
//						$("#expert_sex").text(value.sex);
						$("#expert_ethnic").text(value.ethnic);
						$("#expert_org").text(value.organization);
						$("#expert_remarks").text(value.title);
						$("#expert_position").text(value.position);
						$("#expert_des").text(value.descrip);
						$("#expert_addr").text(value.addr);
						$("#expert_mobile").text(value.mobile);
						if(value.sex==0){
							$("#expert_sex").text("男");
						}else{
							$("#expert_sex").text("女");
						}

						return false;
					}
			    });
			}

			//TODO 显示周边(参数为事件id,暂时不根据周边查询)
			function showArround(eventId) {
				$.ajax({
					url:'/geoInfo/getArround',
					dataType:'json',
					type:'get',
					success:function(result){
						
						$("#crowdTable").empty();
						$("#buildingTable").empty();
						if(result.length<0){
							alert("操作失败");
							return;
						}else{
							for (var i in result){
								if(result[i].attention_type == 'crowd'){//人群
									if(result[i].name == '小学'){
										$("#crowdTable").append('<tr><td class="col-xs-6">'+result[i].name+'</td><td class="colornum">'+result[i].typenumber+'间('+result[i].number+'人)</td></tr>');
									}else{
										$("#crowdTable").append('<tr><td class="col-xs-6">'+result[i].name+'</td><td class="colornum">'+result[i].number+'人</td></tr>');
									}
								}
								if(result[i].attention_type == 'building'){
									$("#buildingTable").append('<tr><td class="col-xs-6">'+result[i].name+'</td><td class="colornum">'+result[i].typenumber+'间('+result[i].number+'人)</td></tr>');
								}
							}
						}
					}
				})
			}

			var getSimilarCase=function(eventId){
	            $.ajax({
	                url:'/dispatch/center/getSimilarCase',
	                dataType:'json',
	                type:'get',
	                data:{
	                    eventId:eventId
	                },
	                success:function(data){
	                    /*console.log(data);
	                    $("#caseTable").empty();
	                    for(var i in data.data){
                            $("#caseTable").append("<tr><td class='col-xs-3'>"+(parseInt(i)+1)+"</td><td class='colornum'>"+data.data[i].planName+"</td></tr>")
					    }*/
	                }
	            })
	        }
			$("#planList").on("click",'.dialog1',function(){
			    $("#planList .dialog1").removeClass("active");
			    $(this).addClass("active");
			})
				var resultArrC=[];
				var resultArrET=[];
				var resultArrE=[];
				var resultArrEX=[];
				var resultArrW=[];
				//加载可调资源
				function loadRes(index,radius){
				        resultArrC=[];
						console.log(index)
						var center=JSON.parse(sessionStorage.getItem("data")).data[index].location;
						if(!!center){
							for(var i in cameraJSON.monitorInfoListJson){
								if(cameraJSON.monitorInfoListJson[i].longitude){
									var lonlat=GPS.WGStoGCJ(cameraJSON.monitorInfoListJson[i].latitude,cameraJSON.monitorInfoListJson[i].longitude);
									var long=GPS.distance(center.lat,center.lon,lonlat.lat,lonlat.lon);
									if(!radius){
                                        if(long<=JSON.parse(sessionStorage.getItem("data")).data[index].radius){
                                            resultArrC.push(cameraJSON.monitorInfoListJson[i]);
                                        }
									}else{
									    if(long<=radius){
                                            resultArrC.push(cameraJSON.monitorInfoListJson[i]);
                                        }
									}

								}
							}
							$("#tab2 tr:nth-of-type(5) td").eq(2).text(resultArrC.length+"个");
						}else{
							$("#tab2 tr:nth-of-type(5) td").eq(2).text(resultArrC.length+"个");
						}
						getMapIcon(4);
				$.ajax({
					url:'/dispatch/res/emergencyTeam',
					dataType:'json',
					type:'get',
					success:function(data){
						resultArrET=[];
						var index=$("#planList .active").index();
						var center=JSON.parse(sessionStorage.getItem("data")).data[index].location;
						if(!!center){
							for(var i in data.data){
								if(data.data[i].location){
									var lonlat=GPS.WGStoGCJ(data.data[i].location.lat,data.data[i].location.lon);
									var long=GPS.distance(center.lat,center.lon,lonlat.lat,lonlat.lon);
									if(!radius){
                                        if(long<=JSON.parse(sessionStorage.getItem("data")).data[index].radius){
                                            resultArrET.push(data.data[i]);
                                        }
                                    }else{
									    if(long<=radius){
                                            resultArrET.push(data.data[i]);
                                        }
									}
								}
							}
						}
						$("#tab2 tr:nth-of-type(2) td").eq(2).text(resultArrET.length+"个");
						getMapIcon(1)
					}
				})
				$.ajax({
					url:'/dispatch/res/equipment',
					dataType:'json',
					type:'get',
					success:function(data){
						resultArrE=[];
						var index=$("#planList .active").index();
						var center=JSON.parse(sessionStorage.getItem("data")).data[index].location;
						if(!!center){
							for(var i in data.data){
								if(data.data[i].location){

									//var lonlat=GPS.WGStoGCJ(data.data[i].location.lat,data.data[i].location.lon);
									var lonlat=GPS.WGStoGCJ(data.data[i].location.lon,data.data[i].location.lat);
									var long=GPS.distance(center.lat,center.lon,lonlat.lat,lonlat.lon);
									if(!radius){
									   if(long<=JSON.parse(sessionStorage.getItem("data")).data[index].radius){
											resultArrE.push(data.data[i]);
										}
									}else{
									    if(long<=radius){
											resultArrE.push(data.data[i]);
										}
									}
								}
							}
						}
						$("#tab2 tr:nth-of-type(6) td").eq(2).text(resultArrE.length+"个");
						console.log(data);
						getMapIcon(5)
					}
				})
				$.ajax({
					url:'/dispatch/res/expert',
					dataType:'json',
					type:'get',
					data:{
					    warnTypeId:JSON.parse(sessionStorage.getItem("data")).data[index].warnTypeId
					},
					success:function(data){
						resultArrEX=[];
						for(var i in data.data){
							resultArrEX.push(data.data[i]);
						}
						$("#tab2 tr:nth-of-type(3) td").eq(2).text(data.data.length+"个");
					}
				})
				$.ajax({
					url:'/dispatch/res/watchman',
					dataType:'json',
					type:'get',
					success:function(data){
						resultArrW=[];
						for(var i in data.data){
							resultArrW.push(data.data[i]);
						}
						$("#tab2 tr:nth-of-type(4) td").eq(2).text(data.data.length+"个");
					}
				})
                    console.log(radius);
                    	if(!radius){
							showVeh('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius)
							showGoods('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
							showEmph('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
							drawHydrant('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showHut('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showSGroup('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showLight('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showWstation('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showRstation('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showAstation('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showBehavior('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showIllegal('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showPassenger('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            showFace('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            SBuilding('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius);
                            /*$("#dialog8 tr:nth-of-type(2) td:nth-of-type(2)").text(drawHydrant('','',JSON.parse(sessionStorage.getItem("data")).data[index].radius));*/
                        }else{
							showVeh('','',radius);
							showGoods('','',radius);
							showEmph('','',radius);
							drawHydrant('','',radius);
							showHut('','',radius);
                            showSGroup('','',radius);
                            showLight('','',radius);
                            showWstation('','',radius);
                            showRstation('','',radius);
                            showAstation('','',radius);
                            showBehavior('','',radius);
                            showIllegal('','',radius);
                            showPassenger('','',radius);
                            showFace('','',radius);
                            SBuilding('','',radius);
                        }
							
			}


		//点击可调资源后地图打点
				function getMapIcon(cIndex){
				    switch(parseInt(cIndex)){
						case 1:
						    if(resultArrET.length>0){
						        for(var i in resultArrET){
									var lonlat=GPS.WGStoGCJ(resultArrET[i].location.lat,resultArrET[i].location.lon);
						            var marker=new AMap.Marker({
											position:new AMap.LngLat(lonlat.lon,lonlat.lat),
											offset:new AMap.Pixel(-10,-10),
											icon:'../img/mapIcon/7_05.png',
											title:resultArrET[i].teamName,
											data:resultArrET[i]
									})
                                    marker.on('click',getTeamInfo);
                                    map.add(marker);
                                }
							}

							break;
						case 4:
						    if(resultArrC.length>0){
						        var tmp=[];
						        for(var i in resultArrC){
						            var lonlat=GPS.WGStoGCJ(resultArrC[i].latitude,resultArrC[i].longitude);
						            //var lonlat=GPS.WGStoGCJ(resultArrC[i].longitude,resultArrC[i].latitude);
						            var marker=new AMap.Marker({
											position:new AMap.LngLat(lonlat.lon,lonlat.lat),
											//position:new AMap.LngLat(lonlat.lat,lonlat.lon),
											offset:new AMap.Pixel(-10,-10),
											icon:'../img/mapIcon/7_20.png',
											title:resultArrC[i].id,
											data:{
											    number:resultArrC[i].number
											}
										})
									tmp.push(marker)
					        		marker.on('click',openCamera);
                            		map.add(marker);
								}
								EArr[0]=resultArrC.length
								EArr1[0]=tmp;
							}
						case 5:
						    if(resultArrE.length>0){
						        for(var i in resultArrE){
						            var lonlat=GPS.WGStoGCJ(resultArrE[i].location.lat,resultArrE[i].location.lon);
						            var marker=new AMap.Marker({
											position:new AMap.LngLat(lonlat.lon,lonlat.lat),
											offset:new AMap.Pixel(-10,-10),
											icon:'../img/mapIcon/7_09.png',
											title:resultArrE[i].name,
											data:{
							    				name:resultArrE[i].name,
												contact:resultArrE[i].contact,
												mobile:resultArrE[i].mobile
											}
									})
									marker.on('click',getEquipmentInfo);
									map.add(marker);
								}
							}
					}
				}



         $("#camera").on("click",function(){
             	for(var i in cameraJSON.monitorInfoListJson){
             	    if(!!cameraJSON.monitorInfoListJson[i].longitude){
             	        var lonlat=GPS.WGStoGCJ(cameraJSON.monitorInfoListJson[i].latitude,cameraJSON.monitorInfoListJson[i].longitude);
             	        //var lonlat=GPS.WGStoGCJ(cameraJSON.monitorInfoListJson[i].longitude,cameraJSON.monitorInfoListJson[i].latitude);
						var marker=new AMap.Marker({
							position:new AMap.LngLat(lonlat.lon,lonlat.lat),
							//position:new AMap.LngLat(lonlat.lat,lonlat.lon),
							offset:new AMap.Pixel(-10,-10),
							icon:'../img/mapIcon/7_20.png',
							title:cameraJSON.monitorInfoListJson[i].id,
							data:{
								number:cameraJSON.monitorInfoListJson[i].number,
								ip:cameraJSON.monitorInfoListJson[i].ip
							}
						})
						marker.on('click',openCamera);
						map.add(marker);
						}
                    }
             		map.setZoom(14);
             		/*var tem=GPS.WGStoGCJ(cameraJSON.monitorInfoListJson[15].latitude,cameraJSON.monitorInfoListJson[15].longitude);
			 		map.setCenter([tem.lon,tem.lat])*/
			 		var tem=GPS.WGStoGCJ(cameraJSON.monitorInfoListJson[15].longitude,cameraJSON.monitorInfoListJson[15].latitude);
			 		map.setCenter([tem.lat,tem.lon])
				})

		var openCamera=function (data) {
			$("#dialog4").show();
			$("#videoContent").empty();
			AMap.plugin('AMap.Geocoder',function(){
			    var geocoder= new AMap.Geocoder({});
			    var lnglat=[data.lnglat.lng,data.lnglat.lat];
			    geocoder.getAddress(lnglat,function (status,result) {
                    if (status === 'complete' && result.info === 'OK') {
                        $("#videoContent").append("<div style='font-weight: 300;padding-bottom: 10px;'><div class='pop_box'>监控视频:"+data.target.getTitle()+"</div><div class='pop_box'>地址："+result.regeocode.formattedAddress+"</div><div class='pop_box'>ip："+data.target.get('data').ip+"</div><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"' style='position: absolute;top:80px;right:50px'>从这里出发</div></div>");
						$("#videoContent").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+data.target.get("data").number+"&iframe=yes&aspect=640x360' width='650' height='370' allowfullscreen allow='autoplay' id='videoFrame'></iframe>");
                    }
                })
			})
        }


		$("#team").on("click",function(){
		    if(!$(this).hasClass("active")){
                $.ajax({
                    url: '/dispatch/res/emergencyTeam',
                    dataType: 'json',
                    type: 'get',
                    success: function (data) {
                        for(var i in data.data){
                            if(data.data[i].location){
                                var lonlat=GPS.WGStoGCJ(data.data[i].location.lat,data.data[i].location.lon);
                                var marker=new AMap.Marker({
                                    position:new AMap.LngLat(lonlat.lon,lonlat.lat),
                                    offset:new AMap.Pixel(-10,-10),
                                    icon:'../img/mapIcon/7_05.png',
                                    title:data.data[i].resId,
                                    data:data.data[i]
                                })
                                marker.on('click',getTeamInfo);
                                map.add(marker);
                                map.setZoom(15);
                                var tmp=GPS.WGStoGCJ(data.data[0].location.lat,data.data[0].location.lon)
                                map.setCenter([tmp.lon,tmp.lat]);
                            }
                        }
                    }
                })
			}
		})
		var getTeamInfo=function(data){
	        var data1=data.target.get("data");
		    var lnglat=[data.lnglat.lng,data.lnglat.lat];
		    var memberStr="";
		    console.log(data1);
		    if(data1.members){
		        memberStr+="<table class='teamMemberT' style='width: 400px;'>";
				for(var i in data1.members){
					memberStr+="<tr style='width: 100%;text-align: center'><td width='20%'>"+(parseInt(i)+1)+"</td><td width='25%'>"+data1.members[i].name+"</td><td width='35%' class='mobileNum'>"+data1.members[i].mobile+"</td>" +
						"<td width='20%'><a class='pad5 colorblue deal'><i class='fa fa-envelope-o'></i></a></td></tr>";
				}
				memberStr+="</table>";
			}else{
		        memberStr="暂无";
			}
		    var content=[
		        "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>应急队伍："+data1.teamName+"</div>",
				"<div style='color:white;padding-left:10px;'class='pop_box'>单位："+data1.mainDeptName+"</div>",
				"<div style='color:white;padding-left:10px;'>人数："+data1.numOfTeam+"</div>",
				"<div style='color:white;padding-left:10px;'>队伍类型："+(data1.teamTypeName?data1.teamTypeName:'')+"</div>",
				"<div style='color:white;padding-left:10px;'>经纬度："+(data1.location?data1.location.lon+"，"+data1.location.lat:"")+"</div>",
				"<div style='color:white;padding-left:10px;'>负责人："+(data1.contact?data1.contact:'')+"</div>",
				"<div style='color:white;padding-left:10px;'>更新时间："+(data1.dataupdatetime?data1.dataupdatetime:'')+"</div>",
				"<div style='color:white;padding-left:10px;'>队伍成员："+memberStr+"</div>" ,
				"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"'>从这里出发</div></div></div>"
			]
			console.log(content.join("<br>"));
			console.log(content.join("<br>"));
			var infoWindow = new AMap.InfoWindow({
				content: content.join("<br>")
			});


			// 打开信息窗体
			infoWindow.open(map,lnglat);
		}

		$("#equipment").on("click",function(){
		    if(!$(this).hasClass("active")){
                $.ajax({
                    url: '/dispatch/res/equipment',
                    dataType: 'json',
                    type: 'get',
                    success: function (data) {
                        for(var i in data.data){
                            if(data.data[i].location) {
                                var lonlat=GPS.WGStoGCJ(data.data[i].location.lat,data.data[i].location.lon);
                                var marker = new AMap.Marker({
                                    position: new AMap.LngLat(lonlat.lon, lonlat.lat),
                                    offset: new AMap.Pixel(-10, -10),
                                    icon: '../img/mapIcon/7_09.png',
                                    title: data.data[i].name,
                                    data: data.data[i]
                                })
                                marker.on('click', getEquipmentInfo);
                                map.add(marker);
                            }
                        }
                        map.setZoom(15);
                        var tmp=GPS.WGStoGCJ(data.data[114].location.lat,data.data[114].location.lon);
                        map.setCenter([tmp.lon,tmp.lat]);
                    }
                })
            }
		})
		var getEquipmentInfo=function(data){
	        var data1=data.target.get("data");
		    var lnglat=[data.lnglat.lng,data.lnglat.lat];
		    var content=[
		        "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>应急装备:"+data.target.getTitle()+"</div>",
				"<div style='color:white;padding-left: 10px;' class='pop_box'>名称："+(data1.name?data1.name:'')+"</div>",
				"<div style='color:white;padding-left: 10px;'>负责人："+(data1.contact?data1.contact:'')+"</div>",
				"<div style='color:white;padding-left: 10px;'>联系电话："+(data1.mobile?data1.mobile:'')+"</div>",
				"<div style='color:white;padding-left: 10px;'>更新时间 ："+(data1.dataupdatetime?data1.dataupdatetime:'')+"</div>",
				"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"'>从这里出发</div></div></div>"
			]
			console.log(content.join("<br>"));
			var infoWindow = new AMap.InfoWindow({
				content: content.join("<br>")
			});

			// 打开信息窗体
			infoWindow.open(map,lnglat);
        	}
			//特殊人群
        	$("#sGroup").on("click",function(){
        	    if($(this).hasClass("active")){
                    showSGroup();
				}
			})

				function showSGroup(name,status,radius){
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/special/populationPosition/getDeviceByParam',
						dataType: 'json',
						type: 'get',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lon_lat) {
									var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
									if(radius){
									    var nowCenter=JSON.parse(sessionStorage.getItem("nowCenter"));
									    var long=GPS.distance(nowCenter.lat,nowCenter.lon,lonlat.lat,lonlat.lon);
									    if(long<radius){
									        count++
									        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_17.png',
												data: data[i]
											})
											marker.on('click', showSGData);
											map.add(marker);
										}
									}else{
									    var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_17.png',
												data: data[i]
											})
											marker.on('click', showSGData);
											map.add(marker);
											map.setZoom(15);
											var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1]);
											map.setCenter([tmp.lon,tmp.lat])
									}
								}
							}
							EArr[4]=count;
						}
					})
				}

				function showSGData(e){
				    var id=e.target.get("data").id;
				    var eData=e.target.get("data");
				    console.log(eData);
				    $.ajax({
						url: '/api/special/populationPosition/getDeviceDetailById',
						dataType: 'json',
						type: 'get',
						data:{
						    id:id
						},
						success:function(data){
						    console.log(data);
						    var heatRate=data.detail.Heart[0].heartrate;
						    if(data.detail.BloodPressure.length>0){
                                var sbp=data.detail.BloodPressure[0].sbp;
                                var dbp=data.detail.BloodPressure[0].dbp;
                            }
						    var walk=data.detail.Walk[data.detail.Walk.length-1].value;
							var lnglat=[e.lnglat.lng,e.lnglat.lat]
		    				var content=[
								"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>特殊人群:</div>",
								"<div style='color:white;padding-left: 10px;' class='pop_box'>姓名："+eData.wearerName+"</div>",
								"<div style='color:white;padding-left: 10px;'>电话："+eData.wearerMobile+"</div>",
								"<div style='color:white;padding-left: 10px;'>地址："+eData.community+"</div>",
                                "<div style='color:white;padding-left: 10px;'>经纬度："+eData.lon_lat+"</div><hr/>",
								"<div style='color:white;padding-left: 10px;'>心率："+heatRate+"</div>",
								"<div style='color:white;padding-left: 10px;'>高血压："+(sbp?sbp:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>低血压："+(dbp?dbp:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>步行步数："+walk+"</div>",
								"<div style='color:white;padding-left: 10px;'>更新时间："+(data.detail.dataupdatetime?data.detail.dataupdatetime:'')+"</div>",
								"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
							]
							console.log(content.join("<br>"));
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						}
					})
				}
			$("#passenger").on("click",function(){
			    if(!$(this).hasClass("active")){
			        showPassenger();
				}
			})

				function showPassenger(name,status,radius){
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/device/pfDeviceInfo/getDeviceByParam',
						dataType: 'json',
						type: 'get',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lon_lat) {
									var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
									if(radius){
									    var nowCenter=JSON.parse(sessionStorage.getItem("nowCenter"));
									    var long=GPS.distance(nowCenter.lat,nowCenter.lon,lonlat.lat,lonlat.lon);
									    if(long<radius){
									        count++;
									        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_07.png',
												data: data[i]
											})
											marker.on('click', showPData);
											map.add(marker);
										}
									}else{
									    var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_07.png',
												data: data[i]
											})
											marker.on('click', showPData);
											map.add(marker);
											map.setZoom(13);
											var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1])
											map.setCenter([tmp.lon,tmp.lat]);
									}
								}
							}
							EArr[11]=count;
						}
					})
				}

				function showPData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/device/pfDeviceInfo/getDeviceDetailById',
                         dataType: 'json',
                         type: 'get',
                         data: {
                             id: id
                         },
						 success:function(result){
                             var lnglat=[e.lnglat.lng,e.lnglat.lat]
                            var address=result.data[0].address;
							var cameraname=result.data[0].cameraname;
							var peopleNum,totalInNum,totalOutNum;
							if(result.detail[0].DensityStatistics[0]){
								peopleNum=result.detail[0].DensityStatistics[0].peoplenum
							}else{
								peopleNum="";
							}
							if(result.detail[0].FlowStatistics[0]){
								totalInNum=result.detail[0].FlowStatistics[0].totalinnum
								totalOutNum=result.detail[0].FlowStatistics[0].totaloutnum
							}else{
								totalInNum="";
								totalOutNum="";
							}
							var content=["<p class='pop_tl'>客流量</p><div class='pop_box'><table></tbody class>"+
								"<tr><td style='width:85px;'>地址：</td><td>"+address+"</td></tr>"+
								"<tr><td>摄像头名称：</td><td>"+cameraname+"</td></tr>"+
								"<tr><td>更新时间：</td><td>"+(result.data[0].dataupdatetime?result.data[0].dataupdatetime:'')+"</td></tr>"+
							"<table class='table-bordered'>	"+
								"</tbody><tr><td style='width:60px;' rowspan='2'>人群密度</td></tr>"+

									"<tr><td width='130px'>区域内人数</td>"+
									"	<td>"+peopleNum+"</td></tr>"+
								"</tbody></table>"+
							"<table class='table-bordered'>	"+
								"</tbody><tr><td style='width:60px;' rowspan='3'>通道客流</td></tr>"+
									"<tr><td width='130px'>1分钟内进入总人数</td>"+
									"	<td>"+totalInNum+"</td></tr>"+
									"<tr><td>1分钟内离开总人数</td>"+
									"	<td>"+totalOutNum+"</td></tr>"+
								"</tbody></table>"+
								"</div>"];
							console.log(content.join("<br>"));
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}
			$("#hydrant").on("click",function(){
			    if(!$(this).hasClass("active")){
                    drawHydrant();
                }
			})
				function drawHydrant(name,status,radius){
				    var tmp=[];
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}

					$.ajax({
						url: '/api/fire/electricDeviceInfo/getDeviceByParam',
						dataType: 'json',
						type: 'get',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lon_lat) {
									var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
									if(radius){
									  	var nowCenter=JSON.parse(sessionStorage.getItem("nowCenter"));
									    var long=GPS.distance(nowCenter.lat,nowCenter.lon,lonlat.lat,lonlat.lon);
									    if(long<radius){
									        count++;
									        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_16.png',
												data: data[i]
											})
											marker.on('click', getHyData);
											map.add(marker);
										}
									}else{
									    var marker = new AMap.Marker({
											position: new AMap.LngLat(lonlat.lon, lonlat.lat),
											offset: new AMap.Pixel(-10, -10),
											icon: '../img/mapIcon/7_16.png',
											data: data[i]
										})
										marker.on('click', getHyData);
										map.add(marker);
										map.setZoom(14);
										var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1]);
										map.setCenter([tmp.lon,tmp.lat]);
									}
								}
							}
							EArr[2]=count;
						}
					})
				}
				function getHyData(e){
				     var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/fire/electricDeviceInfo/getDeviceDetailById',
                         dataType: 'json',
                         type: 'get',
                         data: {
                             id: id
                         },
						 success:function(data){
                             var level,pressure,batteryvalue,signal;
							 if(data.detail.FireWaterCycleV22[0]){
							     if(data.detail.FireWaterCycleV22[0].channel1type==1){
							         level=data.detail.FireWaterCycleV22[0].channel1;
								 }else if(data.detail.FireWaterCycleV22[0].channel1type==0){
							         pressure=data.detail.FireWaterCycleV22[0].channel1;
								 }
								 if(data.detail.FireWaterCycleV22[0].channel2type==1){
							         level=data.detail.FireWaterCycleV22[0].channel2;
								 }else if(data.detail.FireWaterCycleV22[0].channel2type==0){
							         pressure=data.detail.FireWaterCycleV22[0].channel2;
								 }
								 batteryvalue=data.detail.FireWaterCycleV22[0].batteryvalue;
								 signal=data.detail.FireWaterCycleV22[0].signal;
                             }
                             var lnglat=[e.lnglat.lng,e.lnglat.lat]
                             var content=[
									"<div style='padding:font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>消防栓:</div>",
									"<div style='color:white;padding-left: 10px;' class='pop_box'>SN："+(data.data[0].sn?data.data[0].sn:'')+"</div>",
									"<div style='color:white;padding-left: 10px;' class='pop_box'>地址："+(data.data[0].address?data.data[0].address:'')+"</div>",
									"<div style='color:white;padding-left: 10px;' class='pop_box'>经纬度："+(data.data[0].gps?data.data[0].gps:'')+"</div>",
									"<hr/><div style='color:white;padding-left: 10px;'>液位："+(level?level:'')+"</div>",
									"<div style='color:white;padding-left: 10px;'>电压(mV)："+(batteryvalue?batteryvalue:'')+"</div>",
									"<div style='color:white;padding-left: 10px;'>信号强度："+(signal?signal:'')+"</div>",
									"<div style='color:white;padding-left: 10px;'>压力："+(pressure?pressure:'')+"</div>",
									"<div style='color:white;padding-left: 10px;'>更新时间："+(data.data[0].updatetime?data.data[0].updatetime:'')+"</div>",
									"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
								]
								 console.log(content.join("<br>"));
								var infoWindow = new AMap.InfoWindow({
									content: content.join("<br>")
								});

								// 打开信息窗体
								infoWindow.open(map,lnglat);
						 }
                     })
				}
			$("#behavior").on("click",function(){
			    if(!$(this).hasClass("active")){
                    showBehavior();
				}
			})
				function showBehavior(name,status,radius){
				     var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/device/netDeviceInfo/getDeviceByParam',
						dataType: 'json',
						type: 'get',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lon_lat) {
									var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
									if(radius){
									    var nowCenter=JSON.parse(sessionStorage.getItem("nowCenter"));
									    var long=GPS.distance(nowCenter.lat,nowCenter.lon,lonlat.lat,lonlat.lon);
									    if(long<radius){
									        count++;
									        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_19.png',
												data: data[i]
											})
											marker.on('click', showBData);
											map.add(marker);
										}
									}else{
                                        var marker = new AMap.Marker({
                                            position: new AMap.LngLat(lonlat.lon, lonlat.lat),
                                            offset: new AMap.Pixel(-10, -10),
                                            icon: '../img/mapIcon/7_19.png',
                                            data: data[i]
                                        })
                                        marker.on('click', showBData);
                                        map.add(marker);
                                        map.setZoom(14);
										var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1]);
										map.setCenter([tmp.lon,tmp.lat]);
                                    }
								}
							}

							EArr[9]=count;
						}
					})
				}

				function showBData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/device/netDeviceInfo/getDeviceDetailById',
                         dataType: 'json',
                         type: 'get',
                         data: {
                             id: id
                         },
						 success:function(result){
                             var lnglat=[e.lnglat.lng,e.lnglat.lat];
                            var cameraname=result.data[0].cameraname;
							var address=result.data[0].address;
							var village=result.data[0].village;
							var Rioternum,Rioterrenum;
							var Crosslinenum,Crosslinerenum;
							var Leftnum,Leftrenum;
							var Parkingnum,Parkingrrenum;
							var Wandernum,Wanderrenum;
							if(result.detail[0].Crossline[0]){
								Crosslinenum=result.detail[0].Crossline[0].nobjectnum;
								Crosslinerenum=result.detail[0].Crossline[0].ndetectlinenum;
							}else{
								Crosslinenum=0;
								Crosslinerenum=0;
							}
							if(result.detail[0].Left[0]){
								Leftnum=result.detail[0].Left[0].nobjectnum;
								Leftrenum=result.detail[0].Left[0].ndetectlinenum;
							}else{
								Leftnum=0;
								Leftrenum=0;
							}
							if(result.detail[0].Parkingdete[0]){
								Parkingnum=result.detail[0].Parkingdete[0].nobjectnum;
								Parkingrrenum=result.detail[0].Parkingdete[0].ndetectlinenum;
							}else{
								Parkingnum=0;
								Parkingrrenum=0;
							}
							if(result.detail[0].Rioter[0]){
								Rioternum=result.detail[0].Rioter[0].nobjectnum;
								Rioterrenum=result.detail[0].Rioter[0].ndetectregionnum;
							}else{
								Rioternum=0;
								Rioterrenum=0;
							}
							if(result.detail[0].Parkingdete[0]){
								Wandernum=result.detail[0].Parkingdete[0].nobjectnum;
								Wanderrenum=result.detail[0].Parkingdete[0].ndetectregionnum;
							}else{
								Wandernum=0;
								Wanderrenum=0;
							}
							if(result.data.length>0){
							    var ut=result.data[0].dataupdatetime;
							}


							var content=["<p class='pop_tl'>行为识别</p><div class='pop_box'><table></tbody class>"+
								"<tr><td style='width:85px;'>摄像机名称：</td><td>"+cameraname+"</td></tr>"+
								"<tr><td>地址：</td><td>"+(address?address:'')+"</td></tr>"+
								"<tr><td>村庄：</td><td>"+village+"</td></tr>"+
								"<tr><td>更新时间：</td><td>"+(ut?ut:'')+"</td></tr>"+
							"</tbody></table>"+
							"<table class='table-bordered'>	"+
								"</tbody><tr><td style='width:60px;' rowspan='3'>警戒线</td></tr>"+
									"<tr><td width='145px'>检测到的物体个数</td>"+
									"	<td>"+Crosslinenum+"</td></tr>"+
									"<tr><td>规则检测区域顶点数</td>"+
									"	<td>"+Crosslinerenum+"</td></tr>"+
								"</tbody></table>"+
							"<table class='table-bordered'>	"+
								"</tbody><tr><td style='width:60px;' rowspan='3'>物品遗失</td></tr>"+
									"<tr><td width='145px'>检测到的物体个数</td>"+
									"	<td>"+Leftnum+"</td></tr>"+
									"<tr><td>规则检测区域顶点数</td>"+
									"	<td>"+Leftrenum+"</td></tr>"+
								"</tbody></table>"+
							"<table class='table-bordered'>	"+
									"</tbody><tr><td style='width:60px;' rowspan='3'>非法停车</td></tr>"+
										"<tr><td width='145px'>检测到的物体个数</td>"+
										"	<td>"+Parkingnum+"</td></tr>"+
										"<tr><td>规则检测区域顶点数</td>"+
										"	<td>"+Parkingrrenum+"</td></tr>"+
									"</tbody></table>"+
							"<table class='table-bordered'>	"+
								"</tbody><tr><td style='width:60px;' rowspan='3'>聚众</td></tr>"+
									"<tr><td width='145px'>检测到的物体个数</td>"+
									"	<td>"+Rioternum+"</td></tr>"+
									"<tr><td>规则检测区域顶点数</td>"+
									"	<td>"+Rioterrenum+"</td></tr>"+
								"</tbody></table>"+
							"<table class='table-bordered'>	"+
								"</tbody><tr><td style='width:60px;' rowspan='3'>徘徊</td></tr>"+
									"<tr><td width='145px'>检测到的物体个数</td>"+
									"	<td>"+Wandernum+"</td></tr>"+
									"<tr><td>规则检测区域顶点数</td>"+
									"	<td>"+Wanderrenum+"</td></tr>"+
								"</tbody></table>"+
								"</div>"];
							console.log(content.join("<br>"));
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}
			$("#light").on("click",function(){
			    if(!$(this).hasClass("active")){
                    showLight();
				}
			})

				function showLight(name,status,radius){
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/lamp/terminalBox/getDeviceByParam',
						dataType: 'json',
						type: 'get',
						data:data1,
						success: function (data) {
						    var count=0;
                            for(var i in data){
                                if(data[i].lon_lat) {
                                    var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
                                    console.log(lonlat)
                                    if(radius){
                                        var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                                        var long=GPS.distance(nowCenter.lat,nowCenter.lon,lonlat.lat,lonlat.lon);
									    if(long<radius){
									        count++;
									        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_11.png',
												data: data[i]
											})
											marker.on('click', showLightData);
											map.add(marker);
                                        }
									}else{
                                        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_11.png',
												data: data[i]
											})
											marker.on('click', showLightData);
											map.add(marker);
											map.setZoom(15);
											var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1]);
											map.setCenter([tmp.lon,tmp.lat]);
									}
                                }
                            }
							EArr[5]=count;
						}
					})
				}

				function showLightData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/lamp/terminalBox/getDeviceDetailById',
                         dataType: 'json',
                         type: 'get',
                         data: {
                             id: id
                         },
						 success:function(data){
                             if(data.data.length>0){
                                 var no=data.data[0].terminalBoxNo;
                                 var road_name=data.data[0].roadName;
                                 var address=data.data[0].address;
                                 var area_name=data.data[0].areaName;
                                 var ud=data.data[0].dataupdatetime;
							 }
							var lnglat=[e.lnglat.lng,e.lnglat.lat]
		    				var content=[
								"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>智慧路灯:</div>",
								"<div style='color:white;padding-left: 10px;' class='pop_box'>编号："+(no?no:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>道路名称："+(road_name?road_name:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>地址："+(address?address:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>更新时间："+(ud?ud:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>片区名称："+(area_name?area_name:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>责任人及电话：</div>",
								"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
							]
							console.log(content.join("<br>"));
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}
			$("#astation").on("click",function(){
			    if(!$(this).hasClass("active")){
			        showAstation();
				}
			})
				function showAstation(name,status,radius){
				    var count=0;
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/aqi/aqiDevice/getByName',
						dataType: 'json',
						type: 'post',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lon_lat) {
									var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
									if (radius){
									    var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
									    var long=GPS.distance(nowCenter.lat,nowCenter.lon,lonlat.lat,lonlat.lon);
									    if(long<radius){
									        count++;
									        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_06.png',
												data: data[i]
											})
											marker.on('click', showAData);
											map.add(marker);
                                        }
									}else{
									    var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_06.png',
												data: data[i]
											})
											marker.on('click', showAData);
											map.add(marker);
											map.setZoom(14);
											var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1]);
											map.setCenter([tmp.lon,tmp.lat]);
									}
								}
							}

							EArr[8]=count;
						}
					})
				}

				function showAData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/aqi/aqiDevice/getDeviceDataById',
                         dataType: 'json',
                         type: 'post',
                         data: {
                             id: id
                         },
						 success:function(data){
                             if(data.deviceData.data[0]){
                                 var co=data.deviceData.data[0].co;
                                 var no2=data.deviceData.data[0].no2;
                                 var o3=data.deviceData.data[0].o3;
                                 var so2=data.deviceData.data[0].so2;
                                 var pm10=data.deviceData.data[0].pm10;
							 }
							 if(data.deviceInfo){
							     var sn=data.deviceInfo.devicesn;
							     var xy=data.deviceInfo.positionxy;
							     var name=data.deviceInfo.positionname;
							 }
                             var lnglat=[e.lnglat.lng,e.lnglat.lat]
                             var content=[
								"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>空气监测:</div>",
								"<div style='color:white;padding-left: 10px' class='pop_box'>sn："+(sn?sn:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>经纬度："+(xy?xy:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>名称："+(name?name:'')+"</div>",
								"<hr/><div style='color:white;padding-left: 10px'>co："+(co?co:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>no2："+(no2?no2:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>o3："+(o3?o3:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>so2："+(so2?so2:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>pm10："+(pm10?pm10:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>更新时间："+(data.deviceData.dataupdatetime?data.deviceData.dataupdatetime:'')+"</div>",
								"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
							]
							console.log(content.join("<br>"));
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}
			$("#illegal").on("click",function(){
			    if(!$(this).hasClass("active")){
                    showIllegal();
				}
			})
				function showIllegal(name,status,radius){
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/car/serviceMonitor/getByName',
						dataType: 'json',
						type: 'post',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lng) {
									var lonlat=GPS.WGStoGCJ(data[i].lat, data[i].lng);
									if (radius){
									    var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
									    var long=GPS.distance(nowCenter.lat,nowCenter.lon,lonlat.lat,lonlat.lon);
									    if(long<radius){
									        count++;
									        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_01.png',
												data: data[i]
											})
											marker.on('click', showIData);
											map.add(marker);
									    }
                                    }else{
									    var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_01.png',
												data: data[i]
											})
											marker.on('click', showIData);
											map.add(marker);
											map.setZoom(15);
											var tmp=GPS.WGStoGCJ(data[0].lat, data[0].lng);
											map.setCenter([tmp.lon,tmp.lat]);
									}
								}
							}

							EArr[10]=count;
						}
					})
				}

				function showIData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/car/serviceMonitor/getDeviceDataById',
                         dataType: 'json',
                         type: 'post',
                         data: {
                             id: id
                         },
						 success:function(data){
                             var deviceInfo=data.deviceInfo.id;
                             var status=data.deviceInfo.status=="1"?"正常":'异常';
                             var po=(data.deviceInfo.lng?data.deviceInfo.lng:'')+","+(data.deviceInfo.lat?data.deviceInfo.lat:'');
							var lnglat=[e.lnglat.lng,e.lnglat.lat]
		    				var content=[
								"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>两违监测:</div>",
								"<div style='color:white;padding-left: 10px;' class='pop_box'>设备信息："+(deviceInfo?deviceInfo:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>经纬度："+po+"</div>",
								"<hr/><div style='color:white;padding-left: 10px;'>状态："+(status?status:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>更新时间："+(data.deviceInfo.dataupdatetime?data.deviceInfo.dataupdatetime:'')+"</div>",
								"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
							]
							console.log(content.join("<br>"));
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}

			$("#rstation").on("click",function(){
			    if(!$(this).hasClass("active")){
                    showRstation();
				}
			})
				var RA=[];
				function showRstation(name,status,radius){
				    var count=0;
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/device/stStbprpB/getDeviceByParam',
						dataType: 'json',
						type: 'get',
						data:data1,
						success: function (data) {
							for(var i in data){
								if(data[i].lon_lat) {
								    var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0],data[i].lon_lat.split(",")[1]);
								    if (radius) {
                                        var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                                        var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
                                        if (long < radius) {
                                            count++;
                                            var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_15.png',
												data: data[i]
											})
											marker.on('click', showRainData);
											map.add(marker);
                                        }
                                    }else{
								        var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_15.png',
												data: data[i]
											})
											marker.on('click', showRainData);
											map.add(marker);
											map.setZoom(13);
											var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0],data[0].lon_lat.split(",")[1])
											map.setCenter([tmp.lon,tmp.lat]);
									}
								}
							}
							EArr[7]=count;
						}
					})
				}

				function showRainData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/device/stStbprpB/getDeviceDetailById',
                         dataType: 'json',
                         type: 'get',
                         data: {
                             id: id
                         },
						 success:function(data){
                             var rvnm=data.data[0].rvnm;
                             var hnnn=data.data[0].hnnn;
                             var bsnm=data.data[0].bsnm;
                             var frgrd=data.data[0].frgrd;
                             var dtmel=data.data[0].dtmel;
							var lnglat=[e.lnglat.lng,e.lnglat.lat]
		    				var content=[
								"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>水雨情:</div>",
								"<div style='color:white;padding-left: 10px;' class='pop_box'>河流名称："+rvnm+"</div>",
								"<div style='color:white;padding-left: 10px;'>水系名称："+(hnnn?hnnn:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>流域名称："+(bsnm?bsnm:'')+"</div>",
								"<hr/><div style='color:white;padding-left: 10px'>基面高程(m）："+(frgrd?frgrd:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>报汛等级："+(dtmel?dtmel:'')+"</div>",
								"<div style='color:white;padding-left: 10px'>更新时间："+(data.data[0].dataupdatetime?data.data[0].dataupdatetime:'')+"</div>",
								"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
							]
							console.log(content.join("<br>"));
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}
			$("#wstation").on("click",function(){
			    if(!$(this).hasClass("active")){
			        showWstation();
				}
			})
				function showWstation(name,status,radius){
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: 'http://113.108.176.67:8090/zghb/a/app/riverInterface/getPointInfo',
						dataType: 'json',
						type: 'post',
						success: function (data) {
						    count=0;
							for(var i in data){
								if(data[i].point&&data[i].point.cdLatitude) {
									var lonlat=GPS.WGStoGCJ(data[i].point.cdLatitude,data[i].point.cdLongitude);
									if (radius) {
                                        var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                                        var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
                                        if (long < radius) {
                                            count++;
                                            var marker = new AMap.Marker({
                                                position: new AMap.LngLat(lonlat.lon, lonlat.lat),
                                                offset: new AMap.Pixel(-10, -10),
                                                icon: '../img/mapIcon/7_13.png',
                                                data: data[i]
                                            })
                                            marker.on('click', showWaterData);
                                            map.add(marker);
                                        }
                                    }else{
									    var marker = new AMap.Marker({
                                                position: new AMap.LngLat(lonlat.lon, lonlat.lat),
                                                offset: new AMap.Pixel(-10, -10),
                                                icon: '../img/mapIcon/7_13.png',
                                                data: data[i]
                                            })
                                            marker.on('click', showWaterData);
                                            map.add(marker);
                                            map.setZoom(13);
											var tmp=GPS.WGStoGCJ(data[0].point.cdLatitude,data[0].point.cdLongitude);
											map.setCenter([tmp.lon,tmp.lat]);
									}
								}
							}
							EArr[6]=count;
						}
					})
				}

				function showWaterData(e){
				    var codeArr=[];
				    var valueArr=[];
				    var id=e.target.get("data").point.pkid;
				    console.log(id);
				     $.ajax({
                         url: 'http://113.108.176.67:8090/zghb/a/app/riverInterface/getCode',
                         dataType: 'json',
                         type: 'get',
                        /* data: {
                             pointid: id,
							 type:'1'
                         },*/
						 success:function(data){
						     for(var i in data){
						         var obj=new Object();
						         obj.name=data[i].label;
						         obj.code=data[i].value;
						         codeArr.push(obj);
                             }
							console.log(codeArr);
						 }
                     })
                    $.ajax({
                        url: 'http://113.108.176.67:8090/zghb/a/app/riverInterface/getData',
                         dataType: 'json',
                         type: 'get',
                         data: {
                             pointid: id,
							 type:'1'
                         },
                        success:function(data){
                            for(var i in data.rows){
                                for(var j in codeArr){
                                    if(codeArr[j].code==data.rows[i].code){
                                        var obj=new Object();
                                        obj.name=codeArr[j].name;
                                        obj.value=data.rows[i].rtd;
                                        valueArr.push(obj);
                                    }
                                }
                            }
                            var lnglat=[e.target.get("data").point.cdLongitude,e.target.get("data").point.cdLatitude]
                            var waterL=getWaterLevel(valueArr[0].value,valueArr[7].value);
                            if(waterL[0]=="Ⅴ级"){
                                var content=[
                                    "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>水质监测:</div>",
                                    "<div style='color:white;padding-left: 10px' class='pop_box'>监测站名称："+(data.rows[0].cdName?data.rows[0].cdName:'')+"</div>",
                                    "<div style='color:white;padding-left: 10px'>监测时间："+(data.rows[0].time?data.rows[0].time:'')+"</div>",
                                    "<table style='width: 800px;text-align: center;font-weight: 500;color:white;'><tr><th>氨氮(mg/L)</th><th>电导率</th><th>悬浮物(mg/L)</th><th>水温(℃)</th><th>溶解氧(mg/L)</th><th>PH值</th><th>站房湿度(%)</th><th>站房温度(℃)</th><th>等级</th><th>首要污染物</th></tr>" +
                                    "<tr><td>"+valueArr[7].value+"</td><td>"+valueArr[4].value+"</td><td>"+valueArr[6].value+"</td><td>"+valueArr[1].value+"</td><td>"+valueArr[0].value+"</td><td>"+valueArr[5].value+"</td><td>"+valueArr[2].value+"</td><td>"+valueArr[3].value+"</td><td class='warn'>"+waterL[0]+"</td><td class='warn'>"+waterL[1]+"</td></tr></table>",
									"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.target.get("data").point.cdLongitude+"' a='"+e.target.get("data").point.cdLatitude+"'>从这里出发</div></div></div>"
                                ]
                            }else{
                                var content=[
                                    "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>水质监测:</div>",
                                    "<div style='color:white;padding-left: 10px' class='pop_box'>监测站名称："+(data.rows[0].cdName?data.rows[0].cdName:'')+"</div>",
                                    "<div style='color:white;padding-left: 10px'>监测时间："+(data.rows[0].time?data.rows[0].time:'')+"</div>",
                                    "<table style='width: 800px;text-align: center;font-weight: 500;color:white;'><tr><th>氨氮(mg/L)</th><th>电导率</th><th>悬浮物(mg/L)</th><th>水温(℃)</th><th>溶解氧(mg/L)</th><th>PH值</th><th>站房湿度(%)</th><th>站房温度(℃)</th><th>等级</th><th>首要污染物</th></tr>" +
                                    "<tr><td>"+valueArr[7].value+"</td><td>"+valueArr[4].value+"</td><td>"+valueArr[6].value+"</td><td>"+valueArr[1].value+"</td><td>"+valueArr[0].value+"</td><td>"+valueArr[5].value+"</td><td>"+valueArr[2].value+"</td><td>"+valueArr[3].value+"</td><td>"+waterL[0]+"</td><td>"+waterL[1]+"</td></tr></table>" ,
									"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.target.get("data").point.cdLongitude+"' a='"+e.target.get("data").point.cdLatitude+"'>从这里出发</div></div></div>"
                                ]
                            }
							
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
                        }

                    })

				}

				function getWaterLevel(o,n){
				    var oLevel;
				    var nLevel;
				    var LStr=['Ⅰ','Ⅱ','Ⅲ','Ⅳ','Ⅴ'];
				    oLevel = (o>=7.5 && 1) || (o>=6 && 2) || (o>=5 && 3) || (o>=3 && 4) ||(o>=2 && 5) || 5;
				    nLevel = (n<=0.15 && 1) || (n<=0.5 && 2) || (n<=1 && 3) || (n<=1.5 && 4) ||(n<=2 && 5) || 5;
				    if(oLevel>nLevel){
				        return [LStr[oLevel-1]+"级","溶解氧"];
                    }else if(oLevel<nLevel){
				        return [LStr[nLevel-1]+"级","氨氮"];
                    }else{
				        return [LStr[oLevel-1]+"级","溶解氧"];
                    }
                }

			$("#face").on("click",function(){
			    if(!$(this).hasClass("active")){
			     	showFace();
				}

			})
				function showFace(name,status,radius){
				    var count=0
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/face/faceCamera/getByName',
						dataType: 'json',
						type: 'post',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lon_lat) {
									//var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
									var lonlat=GPS.WGStoGCJ( data[i].lon_lat.split(",")[1],data[i].lon_lat.split(",")[0]);
									if (radius) {
                                        var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                                        var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
                                        if (long < radius) {
                                            count++;
                                            var marker = new AMap.Marker({
												//position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												position: new AMap.LngLat(lonlat.lat,lonlat.lon),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_02.png',
												data: data[i]
											})
											marker.on('click', showFData);
											map.add(marker);
                                        }
                                    }else{
									    var marker = new AMap.Marker({
												//position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												position: new AMap.LngLat(lonlat.lat,lonlat.lon),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_02.png',
												data: data[i]
											})
											marker.on('click', showFData);
											map.add(marker);
											map.setZoom(15);
											/*var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1]);
											map.setCenter([tmp.lon,tmp.lat]);*/
											var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[1],data[0].lon_lat.split(",")[0]);
											map.setCenter([tmp.lat,tmp.lon])
									}
								}
							}
							EArr[12]=count;
						}
					})
				}
				function showFData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/face/faceCamera/getDeviceDataById',
                         dataType: 'json',
                         type: 'post',
                         data: {
                             id: id
                         },
						 success:function(data){
                             var name=data.deviceInfo.name;
                             var address=data.deviceInfo.address;
                             var deviceState=data.deviceInfo.status?data.deviceInfo.status:'';
							var lnglat=[e.lnglat.lng,e.lnglat.lat]
		    				var content=[
								"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>人脸识别:</div>",
								"<div style='color:white;padding-left: 10px;' class='pop_box'>名称："+name+"</div>",
								"<div style='color:white;padding-left: 10px;'>地址："+(address?address:'')+"</div>",
								"<hr/><div style='color:white;padding-left: 10px;'>设备状态："+deviceState+"</div>",
								"<div style='color:white;padding-left: 10px;'>更新时间："+(data.deviceInfo.dataupdatetime?data.deviceInfo.dataupdatetime:'')+"</div>",
								"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
							]
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}


			$("#hut").on("click",function(){
			    if(!$(this).hasClass("active")){
                    showHut();
				}
			})

				function showHut(name,status,radius){
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url: '/api/healthy/deviceInfo/getByName',
						dataType: 'json',
						type: 'post',
						data:data1,
						success: function (data) {
						    var count=0;
							for(var i in data){
								if(data[i].lon_lat) {
									var lonlat=GPS.WGStoGCJ(data[i].lon_lat.split(",")[0], data[i].lon_lat.split(",")[1]);
									if (radius) {
                                        var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                                        var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
                                        if (long < radius) {
                                            count++;
                                            var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_04.png',
												data: data[i]
											})
											marker.on('click', showHutData);
											map.add(marker);
                                        }
                                    }else{
									    var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_04.png',
												data: data[i]
											})
											marker.on('click', showHutData);
											map.add(marker);
										map.setZoom(15);
										var tmp=GPS.WGStoGCJ(data[0].lon_lat.split(",")[0], data[0].lon_lat.split(",")[1]);
										map.setCenter([tmp.lon,tmp.lat]);
									}
								}
							}
							EArr[3]=count;
						}
					})
				}

				function showHutData(e){
				    var id=e.target.get("data").id;
				     $.ajax({
                         url: '/api/healthy/deviceInfo/getDeviceDataById',
                         dataType: 'json',
                         type: 'post',
                         data: {
                             id: id
                         },
						 success:function(result){
                             var name=result.deviceInfo.name;
                             var address=result.deviceInfo.address;
                             var deviceState=result.deviceInfo.deviceState;
                             var chol,highdensity,trig,lowdensity;
                             if(result.deviceData.HealthyBloodFat[0]){
								chol=result.deviceData.HealthyBloodFat[0].chol;
								highdensity=result.deviceData.HealthyBloodFat[0].highdensity;
								trig=result.deviceData.HealthyBloodFat[0].trig;
								lowdensity=result.deviceData.HealthyBloodFat[0].lowdensity;
							}else{
								chol=0;
								highdensity=0;
								trig=0;
								lowdensity=0;
							}

							var bloodoxygen,pulse;
							if(result.deviceData.HealthyBloodOxygen[0]){
								bloodoxygen=result.deviceData.HealthyBloodOxygen[0].bloodoxygen;
								pulse=result.deviceData.HealthyBloodOxygen[0].pulse;
							}else{
								bloodoxygen=0;
								pulse=0;
							}

							var systolic,diastolic,pulse;
							if(result.deviceData.HealthyBloodPressure[0]){
								systolic=result.deviceData.HealthyBloodPressure[0].systolic;
								diastolic=result.deviceData.HealthyBloodPressure[0].diastolic;
								pulse=result.deviceData.HealthyBloodPressure[0].pulse;
							}else{
								systolic=0;
								diastolic=0;
								pulse=0;
							}
							var temperature;
							if(result.deviceData.HealthyTemperature[0]){
								temperature=result.deviceData.HealthyTemperature[0].temperature;
							}else{
								temperature=0;
							}
							var lnglat=[e.lnglat.lng,e.lnglat.lat]
		    				var content=[
								"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>健康小屋:</div>",
								"<div style='color:white;padding-left: 10px;' class='pop_box'>名称："+name+"</div>",
								"<div style='color:white;padding-left: 10px;'>地址："+(address?address:'')+"</div>",
								"<hr/><div style='color:white;padding-left: 10px;'>设备状态："+deviceState+"</div>",
								"<div style='color:white;padding-left: 10px;'>更新时间："+(result.deviceData.dataupdatetime?result.deviceData.dataupdatetime:'')+"</div>",
								"<div style='color:white;padding-left: 10px;'>" +
								"<table class='table-bordered' style='width: 100%;text-align: center;'>"+
								"<tr><td style='width:60px;' rowspan='5'>血脂数据</td></tr><tr><td width='120px'>总胆固醇</td><td>"+chol+"</td></tr>"+
									"<tr><td>高密度脂蛋白</td><td>"+highdensity+"</td></tr>"+
									"<tr><td>甘油三酯</td><td>"+trig+"</td></tr>"+
									"<tr><td>低密度脂蛋白</td><td>"+lowdensity+"</td></tr>"+
								"</table>"+
							"<table class='table-bordered' style='width: 100%;text-align: center;'>	"+
								"<tbody><tr><td style='width:60px;' rowspan='3'>血氧数据</td></tr>"+
									"<tr><td width='120px'>血氧</td>"+
									"	<td>"+bloodoxygen+"</td></tr>"+
									"<tr><td>脉搏</td>"+
									"	<td>"+pulse+"</td></tr>"+
								"</tbody></table>"+
							"<table class='table-bordered' style='width: 100%;text-align: center;'>	"+
								"<tbody><tr><td style='width:60px;' rowspan='4'>血压数据</td></tr>"+
									"<tr><td width='120px'>收缩压</td>"+
									"	<td>"+systolic+"</td></tr>"+
									"<tr><td>舒张压</td>"+
									"	<td>"+diastolic+"</td></tr>"+
									"<tr><td>脉搏</td>"+
									"	<td>"+pulse+"</td></tr>"+
								"</tbody></table>"+
							"<table class='table-bordered' style='width: 100%;text-align: center;'>	"+
								"<tbody><tr><td style='width:60px;' rowspan='2'>体温数据</td></tr>"+
									"<tr><td width='120px'>体温</td>"+
									"	<td>"+temperature+"</td></tr>"+
								"</tbody></table></div>",
								"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+e.lnglat.lng+"' a='"+e.lnglat.lat+"'>从这里出发</div></div></div>"
							]
							var infoWindow = new AMap.InfoWindow({
								content: content.join("<br>")
							});

							// 打开信息窗体
							infoWindow.open(map,lnglat);
						 }
                     })
				}

				$("#vehicles").on("click", function() {
				    showVeh()
                })

				function showVeh(name,status,radius){
				    var count=0;
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
				/*$.ajax({
					url: '/dispatch/res/vehicles',
					dataType: 'json',
					type: 'get',
					success: function(result) {
						$.each(result.data,function(idx,item) {
							if(item.location){
							    var lonlat=GPS.WGStoGCJ(item.location.lat,item.location.lon);
							        var marker=new AMap.Marker({
										position:new AMap.LngLat(lonlat.lon,lonlat.lat),
										offset:new AMap.Pixel(-10,-10),
										icon:'../img/mapIcon/c01.png',
										title:item.name
							        })
								map.add(marker);
								marker.on('click',getVehicleInfo);
							}
					   });
					}
				})*/
				var lonlat={lon:113.892436,lat:23.416955};
				if (radius) {
					var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
					var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
					if (long < radius) {
						count++;
						var marker = new AMap.Marker({
							position: new AMap.LngLat(lonlat.lon, lonlat.lat),
							offset: new AMap.Pixel(-10, -10),
							icon: '../img/mapIcon/c01.png',
							/*data: data[i]*/
						})
						marker.on('click', getVehicleInfo);
						map.add(marker);
					}
				}else{
					var marker = new AMap.Marker({
						position: new AMap.LngLat(lonlat.lon, lonlat.lat),
						offset: new AMap.Pixel(-10, -10),
						icon: '../img/mapIcon/c01.png',
						/*data: data[i]*/
					})
					marker.on('click', getVehicleInfo);
					map.add(marker);
					map.setZoom(15);
					map.setCenter([lonlat.lon,lonlat.lat]);
				}
				EArr[1]=count
			}
			
			var getVehicleInfo=function(data){
				    var lnglat=[data.lnglat.lng,data.lnglat.lat];
				/*AMap.plugin('AMap.Geocoder',function(){
				    var geocoder= new AMap.Geocoder({});

				    geocoder.getAddress(lnglat,function (status,result) {
						if(status === 'complete' && result.info === 'OK'){

						}
	                })
				})*/
				var content=[
					"<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>应急车辆:</div>",
					"<div style='color:white;padding-left: 10px;' class='pop_box'>地址：正果镇政府</div>" +
					"<div style='color:white;padding-left: 10px;' class='pop_box'>值班人员：<table>" +
					"<tr><td>钟敏健</td><td>13710285262</td></tr><tr><td>邹金宏</td><td>13602736432</td></tr><tr><td>张毅锵</td><td>18218637904</td></tr>"+
					"</table></div>" +
					"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"'>从这里出发</div></div></div>"
				]
				var infoWindow = new AMap.InfoWindow({
					content: content.join("<br>")
				});


				// 打开信息窗体
				infoWindow.open(map,lnglat);
			}
			
	//		应急物资
			$("#supplies").on("click", function() {
//				map.clearMap();
				indexsupplie=layer.open({
			    	type: 2,
			    	id:"indexsupplie",
					shade: 0.3,
					closeBtn: 2,
					fixed:false,
					title:false,
					moveType:1,
					area: ['600px', '400px'],
					content: 'ind_supplie.html'
				})
			})
			
			function getSupplies(suppliedata){
				$.each(suppliedata,function(idx,item) {
					if(item.location){
					    var lonlat=GPS.WGStoGCJ(item.location.lat,item.location.lon);
						var marker=new AMap.Marker({
							position:new AMap.LngLat(lonlat.lon,lonlat.lat),
							offset:new AMap.Pixel(-10,-10),
							icon:'../img/mapIcon/7_10.png',
							title:item.houseName,
							data:{
								goodNum:item.goodNum,
								houseName:item.houseName,
								goodName:item.goodInfo.goodName,
							}
						})
						map.add(marker);
						map.setZoom(14);
						marker.on('click',getSupplieInfo);
					}
				});
			}
			var getSupplieInfo=function(data){
				var data1=data.target.get("data");
			    var lnglat=[data.lnglat.lng,data.lnglat.lat];
			    var content=[
			        "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>应急物资:"+data1.goodName+"</div>",
					"<div style='color:white;padding-left: 10px' class='pop_box'>数量："+data1.goodNum+"</div>",
					"<div style='color:white;padding-left: 10px'>所属仓库："+data1.houseName+"</div>",
					"<div style='color:white;padding-left: 10px'>更新时间："+(data1.dataupdatetime?data1.dataupdatetime:'')+"</div>",
					"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"'>从这里出发</div></div></div>"
				]
				var infoWindow = new AMap.InfoWindow({
					content: content.join("<br>")
				});
				infoWindow.open(map,lnglat);
				
			}
			var getSupplieInfo1=function(data){
				var data1=data.target.get("data");
			    var lnglat=[data.lnglat.lng,data.lnglat.lat];
			    var content=[
			        "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>应急物资:"+data1.goodInfo.goodName+"</div>",
					"<div style='color:white;padding-left: 10px' class='pop_box'>数量："+data1.goodNum+"</div>",
					"<div style='color:white;padding-left: 10px'>所属仓库："+data1.houseName+"</div>",
					"<div style='color:white;padding-left: 10px'>更新时间："+(data1.dataupdatetime?data1.dataupdatetime:'')+"</div>",
					"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"'>从这里出发</div></div></div>"
				]
				var infoWindow = new AMap.InfoWindow({
					content: content.join("<br>")
				});
				infoWindow.open(map,lnglat);

			}
			
			
	//		重点保护对象
			$("#emphasis").on("click", function() {
//				map.clearMap();
				indexemphasis=layer.open({
			    	type: 2,
			    	id:"emphasisinfo",
					shade: 0.3,
					closeBtn: 2,
					fixed:false,
					title:false,
					moveType:1,
					area: ['600px', '400px'],
					content: 'ind_emphasis.html'
				})
			})
			
			function getEmphasis(emphasisInfo){
				$.each(emphasisInfo,function(index,val){
					var type=val.name;
					$.each(val.geoInfos,function(idx,item) {
						if(item.lat_lon){
							var lonlat=GPS.WGStoGCJ(item.lat_lon.split(",")[0],item.lat_lon.split(",")[1]);
							    var marker=new AMap.Marker({
								position:new AMap.LngLat(lonlat.lon,lonlat.lat),
								offset:new AMap.Pixel(-10,-10),
								icon:'../img/mapIcon/7_14.png',
								title:emphasisInfo.name,
								data:{
									type:type,
									name:item.name,
								    number:item.number,
									addr:item.addr
								}
							})
							map.add(marker);
							map.setZoom(14);
							marker.on('click',getEmphasisInfo);

						}
				  	});
				})
				
			}
			var getEmphasisInfo=function(data){
				var data1=data.target.get("data");
			    var lnglat=[data.lnglat.lng,data.lnglat.lat];
			    var content=[
			        "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>保护对象:"+data1.name+"</div>",
			        "<div style='color:white;padding-left: 10px' class='pop_box'>对象名称："+data1.name+"</div>",
					"<div style='color:white;padding-left: 10px'>人数："+data1.number+"</div>",
					"<div style='color:white;padding-left: 10px'>地点："+data1.addr+"</div>",
					"<div style='color:white;padding-left: 10px'>更新时间："+(data1.dataupdatetime?data1.dataupdatetime:'')+"</div>",
					"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"'>从这里出发</div></div></div>"
				]
				var infoWindow = new AMap.InfoWindow({
					content: content.join("<br>")
				});
				infoWindow.open(map,lnglat);
				
			}
			function showEmph(name,status,radius){
				    var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
				    $.ajax({
                        url: '/dispatch/center/geoInfo',
                        dataType: 'json',
                        type: 'get',
						data:data1,
                        success: function (res) {
                           for(var i in res.data){
                               for(var j in res.data[i].geoInfos){
                                   if(res.data[i].geoInfos[j].lat_lon){
									var lonlat=GPS.WGStoGCJ(res.data[i].geoInfos[j].lat_lon.split(",")[0],res.data[i].geoInfos[j].lat_lon.split(",")[1]);
									if (radius) {
                                        var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                                        var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
                                        if (long < radius) {
                                            var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_14.png',
												data: res.data[i].geoInfos[j]
											})
											map.add(marker);
											marker.on('click', getEmphasisInfo)
                                        }
                                    }else{
									    var marker = new AMap.Marker({
												position: new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset: new AMap.Pixel(-10, -10),
												icon: '../img/mapIcon/7_14.png',
												data: res.data[i].geoInfos[j]
											})
											map.add(marker);
											marker.on('click', getEmphasisInfo)
									}

                                }
							   }
						   }
                        }
                    })
				}

			function showGoods(name,status,radius){
				var data1=new Object();
				    if(name&&name!=''){
						data1.name=name;
					}
					if(status&&status!=''){
					    data1.status=status;
					}
					$.ajax({
						url:'/dispatch/res/goods',
						dataType:'json',
						type:'get',
						data:data1,
						success:function(res){
						    for(var i in res.data){
						        for(var j in res.data[i].level2){
						            for(var k in res.data[i].level2[j].googs){
						                for(var x in res.data[i].level2[j].googs[k].res){
                                            if(res.data[i].level2[j].googs[k].res[x].location){
                                                var location=res.data[i].level2[j].googs[k].res[x].location;
                                                var lonlat=GPS.WGStoGCJ(location.lat,location.lon);
                                                if (radius) {
                                                    var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                                                    var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
                                                    if (long < radius) {
                                                        var marker=new AMap.Marker({
															position:new AMap.LngLat(lonlat.lon, lonlat.lat),
															offset:new AMap.Pixel(-10,-10),
															icon:'../img/mapIcon/7_10.png',
															data:res.data[i].level2[j].googs[k].res[x]
														})
														map.add(marker);
														marker.on('click',getSupplieInfo1)
                                                    }
                                                }else{
                                                    var marker=new AMap.Marker({
															position:new AMap.LngLat(lonlat.lon, lonlat.lat),
															offset:new AMap.Pixel(-10,-10),
															icon:'../img/mapIcon/7_10.png',
															data:res.data[i].level2[j].googs[k].res[x]
														})
														map.add(marker);
														marker.on('click',getSupplieInfo1)
														map.setZoom(15);
												}
                                            }
                                        }
									}
								}
							}
						}
                    })
			}

			function SBuilding(name,status,radius){
			   	var data1=new Object();
				if(name&&name!=''){
					data1.name=name;
				}
				if(status&&status!=''){
					data1.status=status;
				}
				$.ajax({
					url: '/dispatch/res/getAttentionObject',
					dataType: 'json',
					type: 'get',
					data: data1,
					success: function (res) {
					    for(var i in res.data){
					        for(var j in res.data[i]){
					            console.log(res.data[i][j]);
					            if(res.data[i][j].lat_lon){
					                var lonlat=GPS.WGStoGCJ(res.data[i][j].lat_lon.split(',')[0],res.data[i][j].lat_lon.split(',')[1]);
					                if(radius){
										var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
										var long = GPS.distance(nowCenter.lat, nowCenter.lon, lonlat.lat, lonlat.lon);
										if (long < radius) {
											var marker=new AMap.Marker({
												position:new AMap.LngLat(lonlat.lon, lonlat.lat),
												offset:new AMap.Pixel(-10,-10),
												icon:'../img/mapIcon/7_12.png',
												data:res.data[i][j]
											})
											map.add(marker);
											marker.on('click',getSBuildingInfo)
										}
									}
								}
							}
						}
					}
				})

			}
			function getSBuildingInfo(data){
				var data1=data.target.get("data");
			    var lnglat=[data.lnglat.lng,data.lnglat.lat];
			    var content=[
			        "<div style='font-weight: 300;border:1px solid #f2f2f2;padding-bottom: 10px;'><div style='color:white;' class='pop_tl'>关注对象:"+data1.name+"</div>",
			        "<div style='color:white;padding-left: 10px' class='pop_box'>对象名称："+data1.name+"</div>",
					"<div style='color:white;padding-left: 10px'>人数："+data1.number+"</div>",
					"<div style='color:white;padding-left: 10px'>地点："+data1.addr+"</div>",
					"<div style='color:white;padding-left: 10px'>联系人："+data1.contact+"</div>",
					"<div style='color:white;padding-left: 10px'>备注："+data1.remarks+"</div>",
					"<div style='color:white;padding-left: 10px'>联系电话："+data1.contact_number+"</div>",
					"<hr/><div class='roadBtn' style='text-align: center;'><div class='btn btn-warning from' o='"+data.lnglat.lng+"' a='"+data.lnglat.lat+"'>从这里出发</div></div></div>"
				]
				var infoWindow = new AMap.InfoWindow({
					content: content.join("<br>")
				});
				infoWindow.open(map,lnglat);
			}
		

			function relocate(eventId){
			    map.on("click",mapClick);
			}

			function mapClick(e) {
                var lng = e.lnglat.getLng();
                var lat = e.lnglat.getLat();
                swal({
                        title: "确认",
                        text: "您选择的是经度：" + lng + ",纬度：" + lat + "的点,确定吗？",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonText: "是的",
                        cancelButtonText: "返回重选",
                        closeOnConfirm: false,
                        closeOnCancel: false,
                    },
                    function (isConfirm) {
                        if (isConfirm) {
                            swal.close();
                            AMap.plugin('AMap.Geocoder', function () {
                                var geocoder = new AMap.Geocoder({});
                                var lnglat = [lng, lat];
                                geocoder.getAddress(lnglat, function (status, result) {
                                    if (status === 'complete' && result.info === 'OK') {
                                        $.ajax({
                                            type: 'post',
                                            dataType: 'json',
                                            url: '/dispatch/center/eventReLocation',
                                            data: {
                                                eventId: eventId,
                                                lon: lng,
                                                lat: lat,
                                                address: result.regeocode.formattedAddress
                                            },
                                            success: function (data) {
                                                map.off("click",mapClick);
                                            }
                                        })
                                    }
                                })
                            })
                        } else {
                            swal.close()
                        }
                    }
                )
			}
			var getWarnCenter=function(data){
			    map.clearMap();
			    if(!!data.location){
                    map.setCenter([data.location.lon,data.location.lat]);
                    var marker=new AMap.Marker({
                        position:new AMap.LngLat(data.location.lon,data.location.lat),
                        offset:new AMap.Pixel(-10,-10),
						content:'<div class="custom-content-marker" style="margin-left:-77px;width: 180px;"><img src="../img/warn.png" style="margin-left:77px;"><div style="color:#000;width: 180px;text-align: center;text-shadow:#fff 1px 0 0,#fff 0 1px 0,#fff -1px 0 0,#fff 0 -1px 0;-webkit-text-shadow:#fff 1px 0 0,#fff 0 1px 0,#fff -1px 0 0,#fff 0 -1px 0;-moz-text-shadow:#fff 1px 0 0,#fff 0 1px 0,#fff -1px 0 0,#fff 0 -1px 0;*filter: Glow(color=#fff, strength=1);">'+data.eventDesc+'</div></div>',
                        /*icon:'../img/warn.png'*/
                    })
                    map.add(marker)
					$.ajax({
						url:'https://api.caiyunapp.com/v2/Y2FpeXVuIGFwaSB3ZWI/'+data.location.lon+','+data.location.lat+'/realtime.jsonp?callback=MYCALLBACK1',
						dataType:'jsonp',
						type:'get'
					})
                    var center= new AMap.Circle({
                        center: new AMap.LngLat(data.location.lon, data.location.lat), // 圆心位置
                        radius: data.radius,  //半径
                        strokeColor: "#aaa",  //线颜色
                        strokeOpacity: 0.6,  //线透明度
                        strokeWeight: 2,  //线粗细度
                        fillColor: "#ddff88",  //填充颜色
                        fillOpacity: 0.2 //填充透明度
                    });
                    map.add(center)
					map.plugin(["AMap.CircleEditor"],function(){
						var circleEditor = new AMap.CircleEditor(map,center);
						circleEditor.open();
						circleEditor.on('adjust',function(e){
						    var markers=map.getAllOverlays();
						    map.remove(markers.slice(2,markers.length));
                        	loadRes(sessionStorage.getItem("nowIndex"),e.radius);
                        	loadTable();
                        	$("#dialog8").show();
						})
					});

				}
			}

			function MYCALLBACK1(data){
				var result=data.result;
				var aqi=result.aqi;
				var tem=result.temperature+"℃";
				var rain;
				var humidity=(result.humidity*100).toFixed(2)+"%";
				var ws=result.wind.speed+"m/s";
				var wd=windDirectionSwitch(result.wind.direction);
				if(result.precipitation.local.intensity<0.03){
				    rain="无降雨";
				}else if(result.precipitation.local.intensity>=0.03&&result.precipitation.local.intensity<0.25){
				    rain="小雨";
				}else if(result.precipitation.local.intensity>=0.25&&result.precipitation.local.intensity<0.35){
				    rain="中雨";
				}else if(result.precipitation.local.intensity>=0.35&&result.precipitation.local.intensity<0.48){
				    rain="大雨";
				}else if(result.precipitation.local.intensity>=0.48){
				    rain="暴雨";
				}
				var str="";
				str+="<tr><td>AQI:</td><td>"+aqi+"</td></tr>";
                str+="<tr><td>温度：</td><td>"+tem+"</td></tr>";
                str+="<tr><td>降雨：</td><td>"+rain+"</td></tr>"
                str+="<tr><td>湿度：</td><td>"+humidity+"</td></tr>"
                str+="<tr><td>风速：</td><td>"+ws+"</td></tr>"
                str+="<tr><td>风向：</td><td>"+wd+"</td></tr>"
				$("#weatherlist").empty();
				$("#weatherlist").append(str);
			}
			function windDirectionSwitch(degrees) {
                    var windA=["北", "东北偏北", "东北", "东北偏东", "东", "东南偏东", "东南", "东南偏南", "南",
            "西南偏南", "西南", "西南偏西", "西", "西北偏西", "西北", "西北偏北"]
                    var index = 0;
                    if (348.75 <= degrees && degrees <= 360) {
                        index = 0;
                    } else if (0 <= degrees && degrees <= 11.25) {
                        index = 0;
                    } else if (11.25 < degrees && degrees <= 33.75) {
                        index = 1;
                    } else if (33.75 < degrees && degrees <= 56.25) {
                        index = 2;
                    } else if (56.25 < degrees && degrees <= 78.75) {
                        index = 3;
                    } else if (78.75 < degrees && degrees <= 101.25) {
                        index = 4;
                    } else if (101.25 < degrees && degrees <= 123.75) {
                        index = 5;
                    } else if (123.75 < degrees && degrees <= 146.25) {
                        index = 6;
                    } else if (146.25 < degrees && degrees <= 168.75) {
                        index = 7;
                    } else if (168.75 < degrees && degrees <= 191.25) {
                        index = 8;
                    } else if (191.25 < degrees && degrees <= 213.75) {
                        index = 9;
                    } else if (213.75 < degrees && degrees <= 236.25) {
                        index = 10;
                    } else if (236.25 < degrees && degrees <= 258.75) {
                        index = 11;
                    } else if (258.75 < degrees && degrees <= 281.25) {
                        index = 12;
                    } else if (281.25 < degrees && degrees <= 303.75) {
                        index = 13;
                    } else if (303.75 < degrees && degrees <= 326.25) {
                        index = 14;
                    } else if (326.25 < degrees && degrees < 348.75) {
                        index = 15;
                    }
                    return windA[index]
                }


			//结案
			$("#start_btn").on("click",'.sclose',function(){
			    console.log(eventId);
			    $(".sclose").attr("disabled","disabled");
				$.ajax({
					url:'/dispatch/center/event/end',
					data:{
					    eventId:eventId,
						actionProgramId:aId
					},
					type:'post',
					dataType:'json',
					success:function(data){
					    if(!!data&&data.code==0){
                            layer.msg('结案成功！');
                            $("#operat_btn1").removeClass("active");
                            $(".ind_sed_btn li").removeClass("active");
                            $("#tab_case").removeClass("active");
                        }else{
					        layer.msg("结案失败！");
						}
					}
				})
			})
			//地图可调资源的点击发送短信
			$(".sms").on("click",function(){
			    var index=$(this).parents("tr").index();
			    var str="";
			    var jsonArr=[];
			    switch(index){
					case 1:
					    if(resultArrET.length>0){
					        for(var i in resultArrET){
                                str+=resultArrET[i].mobile+",";
                                var obj=new Object();
                                obj.mobile=resultArrET[i].mobile;
                                obj.actionprogramId=aId;
                                jsonArr.push(JSON.parse(JSON.stringify(obj)));
                            }
					        sessionStorage.setItem("mapSend","true");
					        sessionStorage.setItem("mobile",str.substring(0,str.length-1));
					        sessionStorage.setItem("jsonArr",JSON.stringify(jsonArr));
					        loadpane1(pane1)
						}
					    break;
					case 2:
					    if(resultArrEX.length>0) {
                            for (var i in resultArrEX) {
                                str += resultArrEX[i].mobile + ",";
                                var obj = new Object();
                                obj.mobile = resultArrEX[i].mobile;
                                obj.actionprogramId = aId;
                                jsonArr.push(JSON.parse(JSON.stringify(obj)));
                            }
                            sessionStorage.setItem("mapSend", "true");
                            sessionStorage.setItem("mobile", str.substring(0, str.length - 1));
                            sessionStorage.setItem("jsonArr", JSON.stringify(jsonArr));
                            loadpane1(pane1)
                        }
					    break;
					case 3:
					    if(resultArrW.length>0) {
                            for (var i in resultArrW) {
                                str += resultArrW[i].mobile + ",";
                                var obj = new Object();
                                obj.mobile = resultArrW[i].mobile;
                                obj.actionprogramId = aId;
                                jsonArr.push(JSON.parse(JSON.stringify(obj)));
                            }
                            sessionStorage.setItem("mapSend", "true");
                            sessionStorage.setItem("mobile", str.substring(0, str.length - 1));
                            sessionStorage.setItem("jsonArr", JSON.stringify(jsonArr));
                            loadpane1(pane1)
                        }
					    break;
					case 5:
					    if(resultArrE.length>0) {
                            for (var i in resultArrE) {
                                str += resultArrE[i].mobile + ",";
                                var obj = new Object();
                                obj.mobile = resultArrE[i].mobile;
                                obj.actionprogramId = aId;
                                jsonArr.push(JSON.parse(JSON.stringify(obj)));
                            }
                            sessionStorage.setItem("mapSend", "true");
                            sessionStorage.setItem("mobile", str.substring(0, str.length - 1));
                            sessionStorage.setItem("jsonArr", JSON.stringify(jsonArr));
                            loadpane1(pane1)
                        }
					    break;
				}
			})
				$("#map-cont").on("click",'.deal',function(){
				    var jsonArr=[];
				    var mobile=$(this).parent().siblings(".mobileNum").text();
				    var obj=new Object();
				    obj.mobile=mobile;
				    obj.actionprogramId=aId;
				    jsonArr.push(JSON.parse(JSON.stringify(obj)));
				    sessionStorage.setItem("mapSend", "true");
					sessionStorage.setItem("mobile", mobile);
					sessionStorage.setItem("jsonArr", JSON.stringify(jsonArr));
					loadpane1(pane1)

				})
				function loadpane1(pane1) {
                    if (pane1) {
                        layerReload(pane1)
                    } else {
                        /*layer.close(sessionStorage.getItem("oldPane1"));*/
                        pane1 = layer.open({
                            type: 2,
                            id: "infocont1",
                            offset: 'auto',
                            shade: false,
                            closeBtn: 2,
                            fixed: false,
                            title: false,
							moveType:1,
                            area: ['445px', '302px'],
                            skin: '',
                            content: 'ind_info.html',
                            end: function () {
                                pane1 = null;
                            }
                        })
						sessionStorage.setItem("oldPane1",pane1);
                    }
                }

			//反馈接口
				$("#feedback").on("click",function(){
				    sessionStorage.setItem("aId",aId);
				    sessionStorage.setItem("actionId",aId);
					 feedBack=layer.open({
						 type: 2,
						id:"ind_taskquery",
						shade: 0.3,
						closeBtn: 2,
						fixed:false,
						title:false,
						moveType:1,
						area: ['600px', '460px'],
						content: 'ind_taskquery.html',
						 end:function(){
						     sessionStorage.removeItem("taskId");
						 }
					 })
				})

			$("#mapSearch").on('click',function(){
			    $("#dialog6").show();
			})
			$("#mapSubmit").on('click',function() {
                var radiusArr = [500, 1000, 2000, 4000, 10000, 99999999999];
                var type = $("#mapType option:selected").attr("value");
                var name = $("#mapName").val();
                var status = $("#mapStatus option:selected").attr("value");
                var radius;
                var nowCenter = JSON.parse(sessionStorage.getItem("nowCenter"));
                var center = [nowCenter.lon, nowCenter.lat];
                if ($("#mapRadius option:selected").attr("value") != '') {
                    radius = radiusArr[$("#mapRadius option:selected").attr("value")];
                }
                if ($("#mapType option:selected").attr("value") != ''){
                    map.clearMap();
                    switch (parseInt(type)) {
                        case 1:
                            for(var i in cameraJSON.monitorInfoListJson){
								if(cameraJSON.monitorInfoListJson[i].longitude){
								    var lonlat=GPS.WGStoGCJ(cameraJSON.monitorInfoListJson[i].latitude,cameraJSON.monitorInfoListJson[i].longitude);
									var arr=[lonlat.lon,lonlat.lat];
									var long=AMap.GeometryUtil.distance(center,arr);
                                        if(long<=radius){
                                            if(cameraJSON.monitorInfoListJson[i].passageNmae.indexOf(name)>-1){
                                                var marker=new AMap.Marker({
													position:new AMap.LngLat(lonlat.lon,lonlat.lat),
													offset:new AMap.Pixel(-10,-10),
													icon:'../img/mapIcon/7_20.png',
													title:cameraJSON.monitorInfoListJson[i].id,
													data:{
														number:cameraJSON.monitorInfoListJson[i].number,
														ip:cameraJSON.monitorInfoListJson[i].ip
													}
												})
												marker.on('click',openCamera);
												map.add(marker);
                                            }
                                        }
								}
							}
							break;
						case 2:
						    $.ajax({
								url: '/dispatch/res/emergencyTeam',
								dataType: 'json',
								type: 'get',
								success: function (data) {
									for(var i in data.data){
										if(data.data[i].location){
										    var arr=[data.data[i].location.lon,data.data[i].location.lat];
										    var long=AMap.GeometryUtil.distance(center,arr);
										    if(long<=radius){
										        if(data.data[i].teamName.indexOf(name)>-1){
										            var marker=new AMap.Marker({
														position:new AMap.LngLat(data.data[i].location.lon,data.data[i].location.lat),
														offset:new AMap.Pixel(-10,-10),
														icon:'../img/mapIcon/7_05.png',
														title:data.data[i].resId,
														data:{
															dept:data.data[i].mainDeptName,
															contact:data.data[i].contact,
															num:data.data[i].numOfTeam,
															teamTypeName:data.data[i].teamTypeName,
															location:data.data[i].location,
															members:data.data[i].members
														}
													})
													marker.on('click',getTeamInfo);
													map.add(marker);
												}
											}
										}
									}
								}
							})
							break;
						case 3:
						    showVeh(name,status,radius);
							break;
						case 4:
						    $.ajax({
								url: '/dispatch/res/equipment',
								dataType: 'json',
								type: 'get',
								success: function (data) {
									for(var i in data.data){
									      var arr=[item.location.lon,item.location.lat];
										var long=AMap.GeometryUtil.distance(center,arr);
										 if(long<=radius) {
                                             if (data.data[i].name.indexOf(name) > -1) {
                                                 var marker=new AMap.Marker({
													position:new AMap.LngLat(data.data[i].location.lon,data.data[i].location.lat),
													offset:new AMap.Pixel(-10,-10),
													icon:'../img/mapIcon/7_09.png',
													title:data.data[i].name,
													data:{
														name:data.data[i].name,
														contact:data.data[i].contact,
														mobile:data.data[i].mobile
													}
												})
												marker.on('click',getEquipmentInfo);
												map.add(marker);
                                             }
                                         }
									}
								}
							})
							break;
						case 5:
							drawHydrant(name,status,radius);
							break;
						case 6:
						    showHut(name,status,radius);
						    break;
						case 7:
						    showSGroup(name,status,radius);
						    break;
						case 8:
						    showLight(name,status,radius);
						    break;
						case 9:
						    showWstation(name,status,radius);
						    break;
						case 10:
						    showRstation(name,status,radius);
						    break;
						case 11:
						    showAstation(name,status,radius);
						    break;
						case 12:
						    showBehavior(name,status,radius);
						    break;
						case 13:
						    showIllegal(name,status,radius);
						    break;
						case 14:
						    showPassenger(name,status,radius);
						    break;
						case 15:
						    showFace(name,status,radius);
						    break;
                    }
            	}
			})
				$("#mapCancel").on("click",function(){
				   $("#dialog6").hide();
				})
			$(".addEvent").on('click',function(){
				layer.open({
					type: 2,
					id:"Receive",
					shade: false,
					closeBtn: 2,
					fixed:false,
					title:'新增接报信息',
					offset:'auto',
					moveType:1,
					area: ['1000px', '650px'],
					skin: '',
					content: '../../backend/pages/support/receiveInfoForm.html'
				})
			})
			$("a.play").on('click',function(){
			    var length=resultArrC.length;
			    $("#dialog7 .btnCont div").show();
			    if(length==0){

				}else if(length==1){
                    $("#dialog7").show();
                    $("#dialog7 .btnCont div").eq(1).hide();
                    $("#dialog7 .btnCont div").eq(2).hide();
                    $("#videoContent1").css({
						width:'670px',
						height:'390px'
					})
			        $("#videoContent1").empty();
					$("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[0].number+"&iframe=yes&aspect=640x360' width='650' height='370' allowfullscreen allow='autoplay' class='videoFrame'></iframe>");
				}else if (length>1&&length<=4) {
			        $("#dialog7").show();
			        $("#dialog7 .btnCont div").eq(2).hide();
			        $("#videoContent1").css({
						width:'680px',
						height:'400px'
					})
			        $("#videoContent1").empty();
			        for(var i in resultArrC){
                        $("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[i].number+"&iframe=yes&aspect=320x180' width='330' height='190' allowfullscreen allow='autoplay' class='videoFrame' style='float: left;'></iframe>");
                    }
				}else if(length>4&&length<=6){
			        $("#dialog7").show();
			        $("#videoContent1").css({
						width:'770px',
						height:'300px'
					})
			        $("#videoContent1").empty();
			        for(var i in resultArrC){
                        $("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[i].number+"&iframe=yes&aspect=240x135' width='250' height='140' allowfullscreen allow='autoplay' class='videoFrame' style='float: left;'></iframe>");
                    }
				}else if(length>6){
			        $("#dialog7").show();
			        $("#videoContent1").css({
						width:'770px',
						height:'440px'
					})
			        $("#videoContent1").empty();
			        for(var i in resultArrC){
                        $("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[i].number+"&iframe=yes&aspect=240x135' width='250' height='140' allowfullscreen allow='autoplay' class='videoFrame' style='float: left;'></iframe>");
                    }
				}
			})
			function clickCamera(index,min){
				if(resultArrC.length<=index&&resultArrC.length<=min){

				}else{
				    if(index==1){
				        $("#videoContent1").css({
							width:'670px',
							height:'390px'
						})
			        	$("#videoContent1").empty();
						$("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[0].number+"&iframe=yes&aspect=640x360' width='650' height='370' allowfullscreen allow='autoplay' class='videoFrame'></iframe>");
					}
					if(index==4){
						$("#videoContent1").css({
							width:'680px',
							height:'400px'
						})
						$("#videoContent1").empty();
						for(var i=0;i<4;i++){
							$("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[i].number+"&iframe=yes&aspect=320x180' width='330' height='190' allowfullscreen allow='autoplay' class='videoFrame' style='float: left;'></iframe>");
						}
					}
					if(index==9){
					    if(resultArrC.length>4&&resultArrC.length<=6){
							$("#dialog7").show();
							$("#videoContent1").css({
								width:'770px',
								height:'300px'
							})
							$("#videoContent1").empty();
							for(var i in resultArrC){
								$("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[i].number+"&iframe=yes&aspect=240x135' width='250' height='140' allowfullscreen allow='autoplay' class='videoFrame' style='float: left;'></iframe>");
							}
						}else if(resultArrC.length>6){
							$("#dialog7").show();
							$("#videoContent1").css({
								width:'770px',
								height:'440px'
							})
							$("#videoContent1").empty();
							for(var i in resultArrC){
								$("#videoContent1").append("<iframe src='http://172.27.162.39:10800/play.html?channel="+resultArrC[i].number+"&iframe=yes&aspect=240x135' width='250' height='140' allowfullscreen allow='autoplay' class='videoFrame' style='float: left;'></iframe>");
							}
						}
					}
				}
			}
			function playSound()
				{
				  var borswer = window.navigator.userAgent.toLowerCase();
				  if ( borswer.indexOf( "ie" ) >= 0 )
				  {
					//IE内核浏览器
					var strEmbed = '<embed name="embedPlay" src="../sound/8773.mp3" autostart="true" hidden="true" loop="false"></embed>';
					if ( $( "body" ).find( "embed" ).length <= 0 )
					  $( "body" ).append( strEmbed );
					var embed = document.embedPlay;

					//浏览器不支持 audion，则使用 embed 播放
					embed.volume = 100;
					//embed.play();这个不需要
				  } else
				  {
					//非IE内核浏览器
					var strAudio = "<audio id='audioPlay' src='../sound/8773.mp3' hidden='true'>";
					if ( $( "body" ).find( "audio" ).length <= 0 )
					  $( "body" ).append( strAudio );
					var audio = document.getElementById( "audioPlay" );

					//浏览器支持 audion
					audio.play();
				  }
				}
				/*$("body").on('mouseover','#planList',function(e){
				    e.stopPropagation()
				    var s=new Scroll($("#planList"));
				    s.stop();
				})*/
				$/*("body").on('mouseout','#planList',function(e){
				    e.stopPropagation()
				    var s=new Scroll($("#planList"));
				    s.start();
				})*/

			function getSearch(){
				var search=window.location.search;
				if(search!=""){
					var searchA=search.substring(1,search.length).split("=");
					var oldData=JSON.parse(sessionStorage.getItem("data"));
            		for(var i in oldData.data){
            		    if(searchA[1]==oldData.data[i].eventId){
							$("#planList .dialog1").eq(i).trigger('click');
						}
                    }
				}
			}

			function loadTable(){
				var eArr=EArr;
				var tArr=[];
				var str='';
				var typeArr=['摄像头','应急车辆','消防栓','健康小屋','特殊人群','智慧路灯','水质监测','水雨情','AQI','行为识别','两违识别','客流量','人脸识别'];
				$("#dialog8 table").empty();
				for(var i in eArr){
					var o=new Object();
					o.value=eArr[i];
					o.index=parseInt(i);
					tArr.push(o);
				}
				tArr.sort(compare("value",false));
				str+="<tr><td width='60%'>物联设备</td><td>个数</td></tr>";
				for(var i in tArr){
				    if(tArr[i].value>0){
                        str+="<tr><td>"+typeArr[tArr[i].index]+"</td><td>"+tArr[i].value+"</td></tr>";
					}
				}
				$("#dialog8 table").append(str)
			}

			function compare(property,desc) {
            	return function (a, b) {
                	var value1 = a[property];
                	var value2 = b[property];
                	if(desc==true){
                    // 升序排列
                    	return value1 - value2;
                	}else{
                    	// 降序排列
                    	return value2 - value1;
                	}
            	}
        	}
        	$("body").on('click','.to',function(e){
        	    e.stopPropagation();
        	    var o=$(this).attr("o");
        	    var a=$(this).attr("a");
        	    var goal=[o,a];
        	    sessionStorage.setItem("goal",goal);
        	    $("#dialog9").hide();
        	    $("#dialog9 input").val("");
                $("#dialog9 #resultDiv").empty();
        	    $("#dialog10").show();
			})
			$("body").on('click','.from',function(e){
        	    e.stopPropagation();
        	    var o=$(this).attr("o");
        	    var a=$(this).attr("a");
        	    var goal=[o,a];
        	    console.log(goal);
        	    var nowCenter=JSON.parse(sessionStorage.getItem("nowCenter"));
				var start=new AMap.LngLat(goal[0],goal[1]);
				var end=new AMap.LngLat(nowCenter.lon,nowCenter.lat);
				var driving = new AMap.Driving({
						// 驾车路线规划策略，AMap.DrivingPolicy.LEAST_TIME是最快捷模式
					policy: AMap.DrivingPolicy.LEAST_TIME,
					map:map,
					panel:'resultDiv'
				})
				driving.search(start, end, function (status, result) {
					console.log(result);
				})
                $("#dialog10").hide();
                $("#dialog10 #resultDiv").empty();
                $("#dialog9").show();
			})
			$("#getLine").on('click',function(){
			    var goal=sessionStorage.getItem("goal");
			    var nowCenter=sessionStorage.getItem("nowCenter");
				var start=new AMap.LngLat(goal.split(",")[0],goal.split(",")[1]);
				var end=new AMap.LngLat(nowCenter.lon,nowCenter.lat);
				var driving = new AMap.Driving({
						// 驾车路线规划策略，AMap.DrivingPolicy.LEAST_TIME是最快捷模式
					policy: AMap.DrivingPolicy.LEAST_TIME,
					map:map,
					panel:'resultDiv'
				})
				driving.search(start, end, function (status, result) {
					console.log(result);
				})

			})
			$("#getLine1").on('click',function(){
			    var goal=sessionStorage.getItem("goal");
			    var nowCenter=sessionStorage.getItem("nowCenter");
				var end=new AMap.LngLat(goal.split(",")[0],goal.split(",")[1]);
				var start=new AMap.LngLat(nowCenter.lon,nowCenter.lat);
				var driving = new AMap.Driving({
						// 驾车路线规划策略，AMap.DrivingPolicy.LEAST_TIME是最快捷模式
					policy: AMap.DrivingPolicy.LEAST_TIME,
					map:map,
					panel:'resultDiv1'
				})
				driving.search(start, end, function (status, result) {
					console.log(result);
				})
			})
			function clickAfterStart(index){
				$("#planList #plantbtn").eq(index).trigger('click');
			}

			//部门联系方式弹出窗
				$("#list").on("click",".dialog1",function() {
				    var index=$(this).attr("idx");
				    sessionStorage.setItem("contactData",JSON.stringify(editData[index]));
				    if(!!contactLayer){
				        layerReload(contactLayer)
					}else{
                        contactLayer=parent.layer.open({
                            type: 2,
                            id:"contactlist",
                            offset: '100px',
                            shade: false,
                            closeBtn: 2,
                            fixed:false,
                            title:false,
							moveType:1,
							move:'.layui-layer-title',
                            area: ['1000px','600px'],
                            skin: '',
                            content: 'ind_contactlist.html',
							end:function () {
								contactLayer=null;
                            }
                        })
						sessionStorage.setItem("lastIndex",contactLayer);
					}
				})
				//部门联系方式弹出窗
				$("#list1").on("click",".dialog1",function() {
					var index=$(this).attr("idx");
				    sessionStorage.setItem("contactData",JSON.stringify(editData[index]));
				    if(!!contactLayer){
				        layerReload(contactLayer)
					}else{
                        contactLayer=parent.layer.open({
                            type: 2,
                            id:"contactlist",
                            offset: '100px',
                            shade: false,
                            closeBtn: 2,
                            fixed:false,
                            title:false,
							moveType:1,
							move:'.layui-layer-title',
                            area: ['900px','600px'],
                            skin: '',
                            content: 'ind_contactlist.html',
							end:function () {
								contactLayer=null;
                            }
                        })
						sessionStorage.setItem("lastIndex",contactLayer);
					}
				})
//				添加修改任务
				$("#addtask").on("click", function() {
				    sessionStorage.setItem("actionId",aId);
					var layerIndex=parent.layer.open({
				    	type: 2,
				    	id:"taskedit",
						closeBtn: 2,
						fixed:false,
						title:false,
						move:'.border',
						area: ['680px', '500px'],
						content: 'ind_taskedit.html'
					})
				})
				$("#edittask").on("click", function() {
					sessionStorage.setItem("edit","true");
					var index=$("#list .active").index();
					sessionStorage.setItem("editData",JSON.stringify(editData[index]));
					var layerIndex=parent.layer.open({
				    	type: 2,
				    	id:"taskedit",
						closeBtn: 2,
						fixed:false,
						title:false,
						move:true,
						moveType:1,
						area: ['680px', '380px'],
						content: 'ind_taskedit.html'
					})
				})
			$("#deletetask").on("click",function(){
			    var index=$("#list .active").index();
			    $.ajax({
					url:'/dispatch/center/taskStep/delete',
					type:'post',
					dataType:'json',
					data:{
						taskId:editData[index].id,
						flag:JSON.parse(sessionStorage.getItem("contactData")).flag
					},
					success:function(data){
						loadStep(aId);
					}
				})
			})
			$("#feedback1").on("click",function(){
			    var feedbackTask=sessionStorage.setItem("taskId",$('#list .active').attr('dataId'));
			    feedBack=parent.layer.open({
					type: 2,
					id:"ind_taskquery",
					shade: 0.3,
					closeBtn: 2,
					fixed:false,
					title:false,
					moveType:1,
					area: ['600px', '460px'],
					content: 'ind_taskquery.html',
					end:function(){
					    sessionStorage.removeItem("taskId");
					    loadStep(aId);
					}
				})
			})
			$("#feedback2").on("click",function(){
			    var feedbackTask=sessionStorage.setItem("taskId",$('#list1 .active').attr('dataId'));
			    feedBack=parent.layer.open({
					type: 2,
					id:"ind_taskquery",
					shade: 0.3,
					closeBtn: 2,
					fixed:false,
					title:false,
					moveType:1,
					area: ['600px', '460px'],
					content: 'ind_taskquery.html',
					end:function(){
					    sessionStorage.removeItem("taskId");
					    loadStep(aId);
					}
				})
			})
			$("#list").on("click",'.dialog1',function(){
			    $("#list .dialog1").removeClass("active");
			    $(this).addClass("active");
			})
			$("#list1").on("click",'.dialog1',function(){
			    $("#list1 .dialog1").removeClass("active");
			    $(this).addClass("active");
			})
			$("#tab2").on('click','#showExp',function(){
			    $("#operat_dia").show();
			    $("#operat_dia .tab-pane").removeClass("active");
			    $("#operat_dia .tab-pane").removeClass("in");
			    $("#tab_spec").addClass("active");
			    $("#tab_spec").addClass("in");
			})

			function beforeOpen(){
				layer.closeAll();
				for(var i=0;i<$(".ind_dialog:visible").length;i++){
				    $(".ind_dialog .close").trigger('click');
				}
			}
			$(".tab-hide").on('click',function(){
			    $(".leftP").fadeOut(1000);
			})
			$(".left-show").on('click',function(){
			    $(".leftP").fadeIn(500);
			})

			$("#setting").on("click",function(){
			    var part=window.location.host;
			    var host="http://"+part+"/Emergency/web/backend/pages/index.html";
			    window.location.href=host;
			})
			$("#admin").on("click",function(){
			   var part=window.location.host;
			    var host="http://"+part+"/html_zg/index.html";
			    window.location.href=host;
			})
			$("#logout").on("click",function(){
			    var part=window.location.host;
			    var host="http://"+part+"/logout";
			    window.location.href=host;
			})
			function removeMapIcon(id){
				console.log(id);
				var allO=map.getAllOverlays("marker");
				console.log(allO);
				switch (id) {
					case "camera":
						var temp=[];
						for(var i in allO){
						    if(allO[i].getIcon()){
                                if(allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/")+1,allO[i].getIcon().length)=="7_20.png"){
                                    temp.push(allO[i]);
                                }
							}
						}
						map.remove(temp);
						break;
					case "team":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_05.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "vehicles":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "c01.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "supplies":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_10.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "equipment":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_09.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "emphasis":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_14.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "hydrant":
					    var temp=[];
					    for(var i in allO){
                            if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_16.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "hut":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_04.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "sGroup":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_17.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "light":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_25.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "wstation":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_13.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "rstation":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_15.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "astation":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_06.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "behavior":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_19.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "illegal":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_01.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "passenger":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_07.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
					case "face":
					    var temp=[];
					    for(var i in allO){
					        if(allO[i].getIcon()) {
                                if (allO[i].getIcon().substring(allO[i].getIcon().lastIndexOf("/") + 1, allO[i].getIcon().length) == "7_02.png") {
                                    temp.push(allO[i]);
                                }
                            }
						}
						map.remove(temp);
						break;
                }
			}

			$("#case .close").on("click",function(){
			    $("#case").hide();
			})
            $("#command_btn1").attr("href","http://"+window.location.host+"/Emergency/web/backend/pages/index_command.html?username=admin&password=123456&op=1")
		</script>
	</body>
</html>
